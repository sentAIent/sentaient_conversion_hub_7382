const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/countdowns-BaSVBIop.js","assets/js/dynamic-import-helper-CTnsj-vI.js","assets/js/array-YYQw31d9.js","assets/js/style-D-IRYiWS.js","assets/css/style-6nm_MYpP.css","assets/js/Logger-cMW5At62.js","assets/js/string-BBKP9xfj.js","assets/js/errors-DV9ybRQO.js","assets/js/BaseMetric-ClLQP9bU.js","assets/js/compareObjects-R6Hcs7xe.js","assets/js/reactiveCustomization-CEUTOUc3.js","assets/js/VueBase-C55TLWt3.js","assets/js/_commonjsHelpers-B3K3fdV-.js","assets/js/ClickOutside-DCLvi2fj.js","assets/js/pinia-B4IAWUO-.js","assets/js/portal-vue.esm-DdddSpdW.js","assets/js/metrics-DBFa0eDh.js","assets/js/clocks-BKX2E5hE.js","assets/js/focusCollection-DomFSFcG.js","assets/js/itemCollectionMixins-DB9fXink.js","assets/js/addin-CPXlL2UQ.js","assets/js/modal-qMFaWR5h.js","assets/js/enums-1c3kgXdw.js","assets/js/tasksViewState-qOrGChOD.js","assets/js/ViewState-DH0LvQYq.js","assets/js/appZStack-Zxx-wHpo.js","assets/js/handlebarLoader-xbtIzd6B.js","assets/css/addin-DPDlCY_f.css","assets/js/linksViewState-DVC8HnZc.js","assets/js/constants-Bt_TxKWw.js","assets/js/links-C4TPnqUd.js","assets/js/tabsViewState-0t0YQzJN.js","assets/js/tabs-CHwCOwcJ.js","assets/js/promisifiedChrome-vBWwQWBS.js","assets/js/focusModeViewState-DaeRKVyi.js","assets/js/focusModeState-BPyBLUbE.js","assets/js/LocalStorageStoreSyncedItem-DMdfjgsv.js","assets/js/PomodoroTimers-CyrfcuWH.js","assets/js/persistStore-BDYPfxbs.js","assets/js/constants-BfBD_H-d.js","assets/js/pomodoroCompleted-B2E_m1QL.js","assets/js/login-HJtMK9QU.js","assets/js/authService-UjcjSrh8.js","assets/js/auth-BwdMrzFn.js","assets/js/legacyUserMigration-CaazFMYU.js","assets/js/migrateLegacyUserMessageHandler-CZ8nZZlg.js","assets/js/onboarding-B35lV45t.js","assets/js/siteBlockerGroups-BbPmPcem.js","assets/js/constants-Dqx3dGLK.js","assets/js/siteBlockerSession-CZaXee-4.js","assets/js/soundsPlayer-GjAZUggE.js","assets/js/state-S-uBOmbY.js","assets/js/TabLeaderElection-Ddi84wmm.js","assets/js/IframeMessenger-Bn2-eCAG.js","assets/js/soundsViewState-D7LNJV4L.js"])))=>i.map(i=>d[i]);
import{u as e,d as t,w as s,M as a,e as i,ax as o}from"./dynamic-import-helper-CTnsj-vI.js";import{A as n,d as l,M as r,C as c,V as d,B as u}from"./focusModeState-BPyBLUbE.js";import{computedObjectSettings as p,persistentObjectSettings as f}from"./reactiveCustomization-CEUTOUc3.js";import{_}from"./style-D-IRYiWS.js";import{a as b}from"./PomodoroTimers-CyrfcuWH.js";import{p as h}from"./persistStore-BDYPfxbs.js";import{b as w}from"./constants-BfBD_H-d.js";const V={countdowns:()=>y(_((()=>import("./countdowns-BaSVBIop.js").then((e=>e.c))),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),metrics:()=>y(_((()=>import("./metrics-DBFa0eDh.js").then((e=>e.m))),__vite__mapDeps([16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),clocks:()=>y(_((()=>import("./clocks-BKX2E5hE.js").then((e=>e.c))),__vite__mapDeps([17,1,2,3,4,5,6,7,8,10,11,12,13,14,15,9]))),focus:()=>y(_((()=>import("./focusCollection-DomFSFcG.js")),__vite__mapDeps([18,11,1,2,3,4,5,6,12,13,14,15,19,10,20,21,22,23,24,25,26,27]))),linksViewStateStore:()=>y(_((()=>import("./linksViewState-DVC8HnZc.js")),__vite__mapDeps([28,24,1,2,3,4,5,6,25,29]))),linksStore:()=>y(_((()=>import("./links-C4TPnqUd.js").then((e=>e.l))),__vite__mapDeps([30,1,2,3,4,5,6,29,9,14]))),tabsViewStateStore:()=>y(_((()=>import("./tabsViewState-0t0YQzJN.js")),__vite__mapDeps([31,24,1,2,3,4,5,6,25]))),tabsStore:()=>y(_((()=>import("./tabs-CHwCOwcJ.js").then((e=>e.t))),__vite__mapDeps([32,1,2,3,4,5,6,33,21,22]))),focusModeViewStateStore:()=>y(_((()=>import("./focusModeViewState-DaeRKVyi.js")),__vite__mapDeps([34,1,2,3,4,5,6,24,25,35,36,10,11,12,13,14,15,37,38,39]))),focusModeSessionStore:()=>y(_((()=>Promise.resolve().then((()=>S))),void 0))};async function y(e){return(await e).default}const g={pomodoro:{enable:async()=>{m.trigger("centerBelow:show",!1);const s=(await _((async()=>{const{default:e}=await import("./pomodoroCompleted-B2E_m1QL.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([40,1,2,3,4,5,6,38,35,36,37,10,11,12,13,14,15,33,41,42,43,44,22,45,46,21]))).default();return await e((()=>s.loaded)).toBe(!0),s.playing||await s.switchTo(b.Focus),t.delay(n).then((async()=>{m.trigger("pomodoro:focusPromptIfFocusEmpty"),await t.delay(n),m.trigger("pomodoro:focusPromptIfFocusEmpty")})),!0},disable:async()=>{const t=(await _((async()=>{const{default:e}=await import("./pomodoroCompleted-B2E_m1QL.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([40,1,2,3,4,5,6,38,35,36,37,10,11,12,13,14,15,33,41,42,43,44,22,45,46,21]))).default();await e((()=>t.loaded)).toBe(!0),await t.complete({switchAfterComplete:!1,completedManually:!0,playSounds:!1}),t.countDownTimerLength&&(t.countDownTimerLength=null)}},siteBlocker:{enable:async()=>{const e=(await _((async()=>{const{default:e}=await import("./siteBlockerGroups-BbPmPcem.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([47,1,2,3,4,5,6,48,9]))).default(),t=(await _((async()=>{const{default:e}=await import("./siteBlockerGroups-BbPmPcem.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([47,1,2,3,4,5,6,48,9]))).default();e.refresh(),t.refresh();return(await _((async()=>{const{default:e}=await import("./siteBlockerSession-CZaXee-4.js");return{default:e}}),__vite__mapDeps([49,1,2,3,4,5,6,36,47,48,9,33,35,34,24,25,10,11,12,13,14,15,37,38,39,40,41,42,43,44,22,45,46,21]))).default().active},disable:async({enableResult:e,focusing:t})=>{if(t)return;(await _((async()=>{const{default:e}=await import("./siteBlockerSession-CZaXee-4.js");return{default:e}}),__vite__mapDeps([49,1,2,3,4,5,6,36,47,48,9,33,35,34,24,25,10,11,12,13,14,15,37,38,39,40,41,42,43,44,22,45,46,21]))).default().toggleActive(!!e)},shouldEnableOnResume:()=>!0,shouldRemoveDataOnSettingsChangeWhileFocusing:!1,get unsupported(){return t.isPwa()}},soundscapes:{enable:async()=>{var e;const t=(await _((async()=>{const{default:e}=await import("./soundsPlayer-GjAZUggE.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([50,38,1,2,3,4,5,6,51,36,52,35,34,24,25,10,11,12,13,14,15,37,39,40,33,41,42,43,44,22,45,46,21,53,54]))).default();return t.refresh(),{id:null==(e=t.activeItem)?void 0:e.id,paused:t.paused}},disable:async({enableResult:e,focusing:t})=>{if(t||!e)return;const s=e,a=(await _((async()=>{const{default:e}=await import("./soundsPlayer-GjAZUggE.js").then((e=>e.s));return{default:e}}),__vite__mapDeps([50,38,1,2,3,4,5,6,51,36,52,35,34,24,25,10,11,12,13,14,15,37,39,40,33,41,42,43,44,22,45,46,21,53,54]))).default();if(s.id&&!s.paused)a.play(s.id);else if(s.id){const e=a.getItem(s.id);if(!e)return;a.update({activeItem:e,paused:!0})}},shouldEnableOnResume:()=>!0},tabStash:{enable:()=>{},disable:async({enableResult:e,inactive:a})=>{var i;if(a)return;const o=(await V.tabsStore())();if(o.loaded&&!o.loading||(await new Promise((e=>{s((()=>o.loaded),e),o.loading||o.refresh()})),await t.delay(1e3)),m.conditionalFeatures.featureEnabled("plus")||m.conditionalFeatures.featureEnabled("tab-stash-degraded")||(e=null==(i=o.getItems[0])?void 0:i.id),"string"==typeof e){const t=o.getItemById(e);t&&await o.restoreSession(t)}},get unsupported(){return t.isSafari()||t.isPwa()}}},A=["siteBlocker","soundscapes","tabStash"];let E;const I=h((({loadedRef:e,updateAsync:s})=>i("focusModeSession",{state:()=>({start:1,stop:1,appActivationData:{},capacityLimitInfo:{msUsed:0,date:t.getDateOnly(new Date)},lastInteraction:Date.now(),totalTimeFocused:0}),getters:{focusModeActive:e=>!e.stop,loaded:()=>e.value,capacityLimitInfoForToday(){const e=this.capacityLimitInfo,s=m.models.date.get("date"),a=t.getDateOnly(s);return e.date!==a?{date:a,msUsed:0}:e},msUntilOverCapacityLimit(){const e=c,t=this.capacityLimitInfoForToday.msUsed,s=m.models.date.get("seconds").getTime();return e-(t+(this.focusModeActive?s-this.start:0))},isOverCapacityLimit(){return this.msUntilOverCapacityLimit<=0},shouldAutoDisable(){const e=m.models.date.get("date").getTime();return this.focusModeActive&&this.lastInteraction<e-r},totalTimeFocusedIncludingCurrentSession(){const e=m.models.date.get("date").getTime();let t=this.totalTimeFocused;return this.focusModeActive&&(t+=e-this.start),Math.max(t,0)}},actions:{async update(e){await s(e)},async stopAndSaveFocusMode(){const e=this.capacityLimitInfoForToday,s=Date.now(),a=s-this.start;e.msUsed+=a,0!==t.nightsBetween(new Date(s),new Date(this.start))&&e.msUsed>t.MS_IN_1_HOUR&&(e.msUsed=0);const i=this.totalTimeFocused+a;await this.update({stop:s,capacityLimitInfo:e,totalTimeFocused:i,appActivationData:{}}),this.refreshLastInteraction({debounceTime:0})},async startAndSaveFocusMode(e){const t=this.capacityLimitInfoForToday;await this.update({start:Date.now(),stop:null,appActivationData:e,capacityLimitInfo:t}),this.refreshLastInteraction({debounceTime:0})},refreshLastInteraction({debounceTime:e=3e3}={}){this.focusModeActive&&(clearTimeout(E),E=window.setTimeout((()=>{this.update({lastInteraction:Date.now()})}),e))},async disableAppsBeforeStop(e){for(const t of A){const s=g[t];s.unsupported||await s.disable({enableResult:this.appActivationData[t],inactive:e})}}}})),{mode:a.Cache,syncAutomatically:!0});(async()=>{const t=I();await e((()=>t.loaded)).toBe(!0),l.switchOverToWatchedStoreItem((()=>t.focusModeActive))})();const S=Object.freeze(Object.defineProperty({__proto__:null,default:I,useFocusModeSessionStore:I},Symbol.toStringTag,{value:"Module"})),T=()=>{const e=p.focusModeSettings,t=JSON.parse(m.models.customization.persistentSettings.defaultIfNotSet.focusModeSettingsStr);return e.apps={...t.apps,...e.apps},{...t,...e}},v=()=>f,D=async(e,t,s)=>{const a=v().focusModeSettings;a.apps[e]||(a.apps[e]={enabled:!1}),a.apps[e][t]=s,v().focusModeSettings=a,I().focusModeActive&&(await(async(e,t)=>{const s=I(),a=s.appActivationData||{};if(t){const t=await g[e].enable();if(null==t)return;a[e]=t}else await g[e].disable({enableResult:a[e],focusing:!0}),(g[e].shouldRemoveDataOnSettingsChangeWhileFocusing??1)&&delete a[e];await s.update({appActivationData:a})})(e,s),L())},L=()=>{const e=T(),t={notesVisible:e.notesVisible,todoVisible:e.todoVisible,quoteVisible:!1,siteBlockerVisible:e.apps.siteBlocker.enabled,soundscapesVisible:e.apps.soundscapes.enabled,tabsVisible:e.apps.tabStash.enabled,searchVisible:!1,launchpadVisible:!1,focusModeVisible:!0,askAiVisible:e.askAiVisible,linksVisible:e.linksVisible,metricVisible:e.metricsVisible,countdownVisible:e.countdownsVisible,multiClockVisible:e.worldClocksVisible,focusInsightVisible:e.focusInsightVisible,weatherVisible:!1,calendarVisible:e.calendarVisible,dashAppTextLabels:w.Hover};o(t)},M=()=>{m.widgetManager.addVueAppExemption(d,"focusMode"),m.widgetManager.addAppExemption(u,"focusMode")},O=()=>{m.widgetManager.hideApps({layer:"focusMode"}),m.widgetManager.removeVueAppExemption(d,"focusMode"),m.widgetManager.removeAppExemption(u,"focusMode")},R=()=>{o({soundscapesVisible:!!m.conditionalFeatures.featureEnabled("plus")&&null,tabsVisible:!(!m.conditionalFeatures.featureEnabled("tab-stash-degraded")&&!m.conditionalFeatures.featureEnabled("plus"))&&null,notesVisible:null,todoVisible:null,quoteVisible:null,siteBlockerVisible:null,searchVisible:null,launchpadVisible:null,focusModeVisible:null,askAiVisible:null,linksVisible:null,metricVisible:null,countdownVisible:null,multiClockVisible:null,focusInsightVisible:null,weatherVisible:null,calendarVisible:null,dashAppTextLabels:null})};export{M as a,R as b,g as c,v as d,D as e,S as f,T as g,V as i,O as r,L as s,I as u};
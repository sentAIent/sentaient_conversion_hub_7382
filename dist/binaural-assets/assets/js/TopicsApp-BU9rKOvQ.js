import{V as t}from"./dynamic-import-helper-CTnsj-vI.js";import s from"./icon-edit-CgpGeR-V.js";import a from"./icon-close-DRlspKs3.js";import{n as i}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./array-YYQw31d9.js";import"./style-D-IRYiWS.js";import"./Logger-cMW5At62.js";import"./string-BBKP9xfj.js";var e="https://api.momentumdash.com/";const o=new(t.extend({name:"TopicDataManager",data:()=>({rawData:{},topicData:[],loaded:!1}),localStorageKey:"topic_data",created(){this.rawData=localStorage.getObject("topics"),this.rawData&&(this.$set(this,"topicData",this.buildHierarchy(this.rawData)),this.loaded=!0),this.getData().then((t=>{this.rawData=t,localStorage.setObject("topics",this.rawData),this.$set(this,"topicData",this.buildHierarchy(this.rawData)),this.loaded=!0}))},methods:{getData:()=>new Promise(((t,s)=>{$.ajax({url:e+"team/topics",success:s=>{t(s)},error:t=>{s(t)}})})),sort:(t,s)=>t.order-s.order,buildHierarchy(t){let s=[];return t&&t.categories&&t.categories.forEach((t=>{t.topics=[],s.push(t)})),t&&t.topics&&t.topics.forEach((t=>{s.filter((s=>s.id===t.categoryId)).forEach((s=>{s.topics.push(t)}))})),s.sort(this.sort).forEach((t=>t.topics.sort(this.sort))),s}}}));const c=i({name:"TopicsApp",computed:{isLoading:()=>!o.loaded,isEmpty(){return!(this.isLoading||this.topicData&&this.topicData.length)},topicData:()=>o.topicData,isAdmin:()=>m.models.teamInfo.get("team").userIsAdmin,categoryCount(){return"category-num-"+this.topicData.length}},mounted(){m.trigger("notification:hide"),this.addListeners(),m.widgetManager.hideApps({exemptionSelectors:".topics, #team-logo"}),m.trigger("topics:open")},destroyed(){m.widgetManager.showApps(),m.trigger("topics:closed"),this.removeListeners()},methods:{editInAccountSite(){m.commandManager.execute("window.account.open.login","/team/topics")},handleGlobalClick(t){this.$parent.$el&&!this.$parent.$el.contains(t.target)&&this.$emit("close")},addListeners(){m.on("globalEvent:esc",this.closeApp),m.on("globalEvent:click",this.handleGlobalClick)},removeListeners(){m.off("globalEvent:esc",this.closeApp),m.off("globalEvent:click",this.handleGlobalClick)},closeApp(){this.$emit("close")},newTabForFileLink(t){m.utils.newTabForFileLink(t)},isUrlLocalFileLink:t=>m.utils.isUrlLocalFileLink(t)}},(function(){var t=this,i=t._self._c;return i("div",{staticClass:"app app-topics",attrs:{id:"topics-app","data-test":"topics-container"}},[i("header",[i("h2",[t._v("Topics")]),t.isAdmin?i("a",{staticClass:"button button-edit",attrs:{target:"_blank"},on:{click:function(s){return t.editInAccountSite()}}},[i("inline-svg",{staticClass:"icon edit-icon",attrs:{src:s}}),i("span",{staticClass:"edit-label"},[t._v("Edit")])],1):t._e(),i("div",{staticClass:"spacer"}),i("div",{staticClass:"icon-wrapper back",attrs:{"data-test":"close"},on:{click:function(s){return s.stopPropagation(),t.$emit("close")}}},[i("inline-svg",{staticClass:"icon icon-hide",attrs:{src:a}})],1)]),i("section",{staticClass:"topics-main"},[i("div",{staticClass:"spacer spacer-top"}),t.isEmpty?t._e():i("ul",{staticClass:"categories",class:t.categoryCount,attrs:{"data-test":"categories"}},t._l(t.topicData,(function(s,a){return i("li",{key:a,staticClass:"category"},[i("div",{staticClass:"category-header"},[s.iconUrl?i("img",{staticClass:"category-icon",attrs:{src:s.iconUrl}}):t._e(),i("div",{staticClass:"category-title"},[t._v(t._s(s.title))])]),i("ul",{staticClass:"topics",attrs:{"data-test":"topics-list"}},t._l(s.topics,(function(s,a){return i("li",{key:a,staticClass:"topic",attrs:{"data-test":"topic"}},[t.isUrlLocalFileLink(s.url)?i("a",{key:"i",staticClass:"u--pointer",attrs:{title:s.url},on:{click:function(a){return t.newTabForFileLink(s.url)}}},[t._v(" "+t._s(s.title)+" ")]):i("a",{key:"i",attrs:{href:s.url}},[t._v(t._s(s.title))])])})),0)])})),0),t.isLoading?i("section",{staticClass:"empty-state"},[i("span",{staticClass:"empty-message"},[t._v("Loading...")])]):t._e(),t.isEmpty?i("section",{staticClass:"empty-state"},[i("span",{staticClass:"empty-message"},[t._v("Your team hasn't added any topics yet.")])]):t._e(),i("div",{staticClass:"spacer spacer-bot"})])])}),[],!1,null,"1a9bd82f").exports;export{c as default};
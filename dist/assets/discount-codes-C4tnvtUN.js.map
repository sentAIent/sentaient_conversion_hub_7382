{"version":3,"file":"discount-codes-C4tnvtUN.js","sources":["../../public/binaural-assets/js/utils/discount-codes.js"],"sourcesContent":["/**\n * Discount Code System\n * Manages coupon codes for beta testers, friends/family, and employees\n */\n\n// Discount tiers and their codes\nexport const DISCOUNT_CODES = {\n    // 10% Off - Beta Testers\n    'BETA10': { discount: 10, type: 'beta', description: 'Beta Tester' },\n    'EARLYBIRD': { discount: 10, type: 'beta', description: 'Early Access' },\n\n    // 20% Off - Extended Beta / Supporters\n    'BETA20': { discount: 20, type: 'supporter', description: 'Beta Supporter' },\n    'FRIEND20': { discount: 20, type: 'friend', description: 'Friend Discount' },\n\n    // 50% Off - Close Friends & Family\n    'FAMILY50': { discount: 50, type: 'family', description: 'Friends & Family' },\n    'VIP50': { discount: 50, type: 'vip', description: 'VIP Access' },\n\n    // 100% Off - Employees & Core Team\n    'TEAM100': { discount: 100, type: 'employee', description: 'Team Member' },\n    'STAFF': { discount: 100, type: 'employee', description: 'Staff' },\n    'FOUNDER': { discount: 100, type: 'employee', description: 'Founder Circle' }\n};\n\n/**\n * Validate discount code\n * @param {string} code - Coupon code to validate\n * @returns {Object|null} - Discount details or null if invalid\n */\nexport function validateDiscountCode(code) {\n    const upperCode = code.trim().toUpperCase();\n\n    if (DISCOUNT_CODES[upperCode]) {\n        return {\n            code: upperCode,\n            ...DISCOUNT_CODES[upperCode]\n        };\n    }\n\n    return null;\n}\n\n/**\n * Calculate discounted price\n * @param {number} originalPrice - Original price\n * @param {number} discountPercent - Discount percentage (0-100)\n * @returns {number} - Discounted price\n */\nexport function calculateDiscountedPrice(originalPrice, discountPercent) {\n    if (discountPercent >= 100) return 0;\n    if (discountPercent <= 0) return originalPrice;\n\n    const discount = (originalPrice * discountPercent) / 100;\n    return originalPrice - discount;\n}\n\n/**\n * Format discount display\n * @param {number} discountPercent - Discount percentage\n * @returns {string} - Formatted discount text\n */\nexport function formatDiscount(discountPercent) {\n    if (discountPercent >= 100) return 'FREE';\n    return `-${discountPercent}%`;\n}\n\n/**\n * Get discount badge color\n * @param {number} discountPercent - Discount percentage\n * @returns {string} - Color class or style\n */\nexport function getDiscountBadgeColor(discountPercent) {\n    if (discountPercent >= 100) return '#10b981'; // green\n    if (discountPercent >= 50) return '#f59e0b'; // amber\n    if (discountPercent >= 20) return '#60a9ff'; // blue\n    return '#8b5cf6'; // purple\n}\n\n/**\n * Store applied discount code\n * @param {string} code - Coupon code\n */\nexport function storeDiscountCode(code) {\n    localStorage.setItem('mindwave_discount_code', code);\n    localStorage.setItem('mindwave_discount_applied_at', Date.now().toString());\n}\n\n/**\n * Get stored discount code\n * @returns {string|null} - Stored code or null\n */\nexport function getStoredDiscountCode() {\n    const code = localStorage.getItem('mindwave_discount_code');\n    const appliedAt = localStorage.getItem('mindwave_discount_applied_at');\n\n    // Discount codes expire after 30 days\n    if (code && appliedAt) {\n        const daysSinceApplied = (Date.now() - parseInt(appliedAt)) / (1000 * 60 * 60 * 24);\n        if (daysSinceApplied < 30) {\n            return code;\n        }\n    }\n\n    return null;\n}\n\n/**\n * Clear stored discount code\n */\nexport function clearDiscountCode() {\n    localStorage.removeItem('mindwave_discount_code');\n    localStorage.removeItem('mindwave_discount_applied_at');\n}\n\n/**\n * Generate Stripe coupon code parameter\n * Note: Codes must be created in Stripe Dashboard first\n * @param {string} code - Discount code\n * @returns {string} - URL parameter for Stripe\n */\nexport function getStripeCouponParam(code) {\n    const discount = validateDiscountCode(code);\n    if (!discount) return '';\n\n    // Map our codes to Stripe coupon IDs\n    // In Stripe Dashboard, create coupons with IDs matching our codes\n    return `&discounts[0][coupon]=${encodeURIComponent(code)}`;\n}\n\n/**\n * Track discount code usage\n * @param {string} code - Applied code\n * @param {string} tier - Pricing tier\n */\nexport function trackDiscountUsage(code, tier) {\n    if (window.trackFeatureUse) {\n        window.trackFeatureUse('discount_applied', `${code}_${tier}`);\n    }\n\n    // Store in Firestore for analytics\n    const { getAuth } = require('firebase/auth');\n    const { getFirestore, collection, addDoc, serverTimestamp } = require('firebase/firestore');\n\n    try {\n        const auth = getAuth();\n        const db = getFirestore();\n\n        addDoc(collection(db, 'discount_usage'), {\n            code: code,\n            tier: tier,\n            userId: auth.currentUser?.uid || 'anonymous',\n            userEmail: auth.currentUser?.email || null,\n            appliedAt: serverTimestamp()\n        });\n    } catch (error) {\n        console.error('[Discount] Failed to track usage:', error);\n    }\n}\n"],"names":["DISCOUNT_CODES","validateDiscountCode","code","upperCode","calculateDiscountedPrice","originalPrice","discountPercent","discount","formatDiscount","getDiscountBadgeColor","storeDiscountCode","getStoredDiscountCode","appliedAt","clearDiscountCode","getStripeCouponParam","trackDiscountUsage","tier","_a","_b","getAuth","getFirestore","collection","addDoc","serverTimestamp","auth","db","error"],"mappings":"AAMY,MAACA,EAAiB,CAE1B,OAAU,CAAE,SAAU,GAAI,KAAM,OAAQ,YAAa,aAAa,EAClE,UAAa,CAAE,SAAU,GAAI,KAAM,OAAQ,YAAa,cAAc,EAGtE,OAAU,CAAE,SAAU,GAAI,KAAM,YAAa,YAAa,gBAAgB,EAC1E,SAAY,CAAE,SAAU,GAAI,KAAM,SAAU,YAAa,iBAAiB,EAG1E,SAAY,CAAE,SAAU,GAAI,KAAM,SAAU,YAAa,kBAAkB,EAC3E,MAAS,CAAE,SAAU,GAAI,KAAM,MAAO,YAAa,YAAY,EAG/D,QAAW,CAAE,SAAU,IAAK,KAAM,WAAY,YAAa,aAAa,EACxE,MAAS,CAAE,SAAU,IAAK,KAAM,WAAY,YAAa,OAAO,EAChE,QAAW,CAAE,SAAU,IAAK,KAAM,WAAY,YAAa,gBAAgB,CAC/E,EAOO,SAASC,EAAqBC,EAAM,CACvC,MAAMC,EAAYD,EAAK,KAAI,EAAG,YAAW,EAEzC,OAAIF,EAAeG,CAAS,EACjB,CACH,KAAMA,EACN,GAAGH,EAAeG,CAAS,CACvC,EAGW,IACX,CAQO,SAASC,EAAyBC,EAAeC,EAAiB,CACrE,GAAIA,GAAmB,IAAK,MAAO,GACnC,GAAIA,GAAmB,EAAG,OAAOD,EAEjC,MAAME,EAAYF,EAAgBC,EAAmB,IACrD,OAAOD,EAAgBE,CAC3B,CAOO,SAASC,EAAeF,EAAiB,CAC5C,OAAIA,GAAmB,IAAY,OAC5B,IAAIA,CAAe,GAC9B,CAOO,SAASG,EAAsBH,EAAiB,CACnD,OAAIA,GAAmB,IAAY,UAC/BA,GAAmB,GAAW,UAC9BA,GAAmB,GAAW,UAC3B,SACX,CAMO,SAASI,EAAkBR,EAAM,CACpC,aAAa,QAAQ,yBAA0BA,CAAI,EACnD,aAAa,QAAQ,+BAAgC,KAAK,IAAG,EAAG,UAAU,CAC9E,CAMO,SAASS,GAAwB,CACpC,MAAMT,EAAO,aAAa,QAAQ,wBAAwB,EACpDU,EAAY,aAAa,QAAQ,8BAA8B,EAGrE,OAAIV,GAAQU,IACkB,KAAK,MAAQ,SAASA,CAAS,GAAM,MACxC,GACZV,EAIR,IACX,CAKO,SAASW,GAAoB,CAChC,aAAa,WAAW,wBAAwB,EAChD,aAAa,WAAW,8BAA8B,CAC1D,CAQO,SAASC,EAAqBZ,EAAM,CAEvC,OADiBD,EAAqBC,CAAI,EAKnC,yBAAyB,mBAAmBA,CAAI,CAAC,GAJlC,EAK1B,CAOO,SAASa,EAAmBb,EAAMc,EAAM,CAvI/C,IAAAC,EAAAC,EAwIQ,OAAO,iBACP,OAAO,gBAAgB,mBAAoB,GAAGhB,CAAI,IAAIc,CAAI,EAAE,EAIhE,KAAM,CAAE,QAAAG,CAAO,EAAK,QAAQ,eAAe,EACrC,CAAE,aAAAC,EAAc,WAAAC,EAAY,OAAAC,EAAQ,gBAAAC,CAAe,EAAK,QAAQ,oBAAoB,EAE1F,GAAI,CACA,MAAMC,EAAOL,EAAO,EACdM,EAAKL,EAAY,EAEvBE,EAAOD,EAAWI,EAAI,gBAAgB,EAAG,CACrC,KAAMvB,EACN,KAAMc,EACN,SAAQC,EAAAO,EAAK,cAAL,YAAAP,EAAkB,MAAO,YACjC,YAAWC,EAAAM,EAAK,cAAL,YAAAN,EAAkB,QAAS,KACtC,UAAWK,EAAe,CACtC,CAAS,CACL,OAASG,EAAO,CACZ,QAAQ,MAAM,oCAAqCA,CAAK,CAC5D,CACJ"}
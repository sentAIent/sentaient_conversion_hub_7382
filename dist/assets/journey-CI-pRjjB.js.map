{"version":3,"mappings":"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","names":["JOURNEY_STAGES","BADGES","STORAGE_KEY","journeyState","activeJourneySession","isJourneyActive","getActiveJourneySession","clearActiveJourneySession","initJourney","loadProgress","saved","data","e","saveProgress","completeLesson","lessonId","lesson","getAllLessons","l","showBadgeEarned","stage","getProgress","totalLessons","completedCount","getNextLesson","isLessonAvailable","lessons","lessonIndex","previousLesson","isLessonCompleted","badgeId","badge","notification","renderJourneyUI","container","progress","nextLesson","index","stageCompleted","stageLessonsCompleted","completed","isMilestone","isAvailable","isActive","btnClasses","content","clickable","_a","id","earned","lessonNumber","access","showLessonModal","existing","modal","pendingLessonId","currentLesson","_b","durationMinutes","sessionTimer","startAudio","fadeIn","fadeOut","stopAudio","resumeVisuals","syncAllButtons","__vitePreload","n","sessionDurationSelect","timerDisplay","timerProgress","offset","wasCompleted","showLessonCompleteNotification","playIcon","pauseIcon","timerRing"],"ignoreList":[],"sources":["../../public/binaural-assets/js/content/journey.js"],"sourcesContent":["// User Journey Program Module\n// Structured learning path for meditation consistency\n\n// Journey stages and lessons\nexport const JOURNEY_STAGES = [\n    {\n        id: 'foundations',\n        name: 'Foundations',\n        emoji: 'üå±',\n        description: 'Learn the basics of binaural beats',\n        duration: '1-2 weeks',\n        lessons: [\n            {\n                id: 'lesson-1',\n                day: 1,\n                title: 'What Are Binaural Beats?',\n                description: 'Understanding how binaural beats affect your brain',\n                type: 'info',\n                content: `Binaural beats are created when two slightly different frequencies are played in each ear. Your brain perceives the difference as a third tone, which can help guide your brainwaves into specific states.\n\nFor example, if 200Hz plays in your left ear and 210Hz in your right ear, you perceive a 10Hz \"beat\" - an Alpha wave frequency associated with relaxation.`,\n                action: { preset: 'alpha', duration: 5 },\n                completed: false\n            },\n            {\n                id: 'lesson-2',\n                day: 2,\n                title: 'Your First Session',\n                description: '5-minute Alpha wave relaxation',\n                type: 'practice',\n                content: 'Put on your headphones (required for binaural beats), get comfortable, and close your eyes. Let the Alpha waves guide you into a relaxed state.',\n                action: { preset: 'alpha', duration: 5 },\n                completed: false\n            },\n            {\n                id: 'lesson-3',\n                day: 3,\n                title: 'Understanding Brain Waves',\n                description: 'Delta, Theta, Alpha, Beta, Gamma explained',\n                type: 'info',\n                content: `**Delta (0.5-4 Hz)** - Deep sleep, healing\n**Theta (4-8 Hz)** - Meditation, creativity, REM sleep\n**Alpha (8-12 Hz)** - Relaxation, calm focus\n**Beta (12-30 Hz)** - Active thinking, concentration\n**Gamma (30-100 Hz)** - Peak focus, cognitive enhancement`,\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-4',\n                day: 4,\n                title: 'Theta for Meditation',\n                description: '7-minute Theta wave session',\n                type: 'practice',\n                content: 'Theta waves are associated with deep meditation and creativity. This session will help you access a meditative state more easily.',\n                action: { preset: 'theta', duration: 7 },\n                completed: false\n            },\n            {\n                id: 'lesson-5',\n                day: 5,\n                title: 'Creating Your Routine',\n                description: 'Tips for building a daily practice',\n                type: 'info',\n                content: `**Tips for success:**\n‚Ä¢ Same time each day (morning or before bed works best)\n‚Ä¢ Start with just 5-10 minutes\n‚Ä¢ Find a quiet, comfortable space\n‚Ä¢ Use quality headphones\n‚Ä¢ Track your progress (we'll do this for you!)`,\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-6',\n                day: 6,\n                title: 'Beta for Focus',\n                description: '10-minute concentration session',\n                type: 'practice',\n                content: 'Beta waves enhance concentration and alertness. Use this before work or study sessions.',\n                action: { preset: 'beta', duration: 10 },\n                completed: false\n            },\n            {\n                id: 'lesson-7',\n                day: 7,\n                title: 'Week 1 Complete!',\n                description: 'Review and reflection',\n                type: 'milestone',\n                content: 'Congratulations! You\\'ve completed your first week. Reflect on how you felt during each session. Which frequencies resonated most with you?',\n                action: null,\n                completed: false,\n                badge: 'week-1'\n            }\n        ]\n    },\n    {\n        id: 'building-habit',\n        name: 'Building Habits',\n        emoji: 'üåø',\n        description: 'Establish your daily practice',\n        duration: 'Week 3-4',\n        lessons: [\n            {\n                id: 'lesson-8',\n                day: 8,\n                title: 'Morning Integration',\n                description: 'Start your day with focus',\n                type: 'practice',\n                content: 'Use the Wake Up journey to transition from sleep to alertness naturally.',\n                action: { journey: 'wakeUp' },\n                completed: false\n            },\n            {\n                id: 'lesson-9',\n                day: 9,\n                title: 'Longer Sessions',\n                description: '15-minute Alpha session',\n                type: 'practice',\n                content: 'Extending your sessions helps deepen the benefits. Today, try a longer 15-minute relaxation session.',\n                action: { preset: 'alpha', duration: 15 },\n                completed: false\n            },\n            {\n                id: 'lesson-10',\n                day: 10,\n                title: 'Evening Wind Down',\n                description: 'Prepare for restful sleep',\n                type: 'practice',\n                content: 'Use the Wind Down journey 30-60 minutes before bed to transition into sleep mode.',\n                action: { journey: 'windDown' },\n                completed: false\n            },\n            {\n                id: 'lesson-11',\n                day: 11,\n                title: 'Combining with Soundscapes',\n                description: 'Layer nature sounds with frequencies',\n                type: 'info',\n                content: 'Adding ambient sounds like rain, ocean, or forest can enhance your sessions. The binaural beat remains effective underneath the soundscape.',\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-12',\n                day: 12,\n                title: 'Meditation Session',\n                description: 'Deep Theta meditation',\n                type: 'practice',\n                content: 'Use the Meditation journey for a guided frequency sweep into deep meditative states.',\n                action: { journey: 'meditation' },\n                completed: false\n            },\n            {\n                id: 'lesson-13',\n                day: 13,\n                title: 'Rest Day',\n                description: 'Reflection and integration',\n                type: 'info',\n                content: 'Taking breaks is important. Use today to reflect on your experiences so far. Notice any changes in your sleep, focus, or stress levels.',\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-14',\n                day: 14,\n                title: 'Two Weeks Strong!',\n                description: 'Habit milestone achieved',\n                type: 'milestone',\n                content: 'You\\'ve meditated for two weeks! Research shows habits form after 14-21 days of consistency. You\\'re on track!',\n                action: null,\n                completed: false,\n                badge: 'two-weeks'\n            }\n        ]\n    },\n    {\n        id: 'deepening',\n        name: 'Deepening Practice',\n        emoji: 'üå≥',\n        description: 'Advanced techniques and personalization',\n        duration: 'Week 5-8',\n        lessons: [\n            {\n                id: 'lesson-15',\n                day: 15,\n                title: 'Sleep Stories Introduction',\n                description: 'Combine narratives with frequencies',\n                type: 'info',\n                content: 'Sleep stories add a narrative element to your Delta sessions, guiding your mind while the frequencies work on a deeper level.',\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-16',\n                day: 16,\n                title: 'Deep Sleep Session',\n                description: 'Delta waves for restorative rest',\n                type: 'practice',\n                content: 'Use the Deep Sleep journey about 30 minutes before bed. Allow the frequencies to carry you into deep, restorative sleep.',\n                action: { journey: 'deepSleep' },\n                completed: false\n            },\n            {\n                id: 'lesson-17',\n                day: 17,\n                title: 'Creative Flow State',\n                description: 'Theta for creativity',\n                type: 'practice',\n                content: 'Artists, writers, and creators often use Theta to access flow states. Try this before any creative work.',\n                action: { journey: 'creativity' },\n                completed: false\n            },\n            {\n                id: 'lesson-18',\n                day: 18,\n                title: 'Mu Waves Exploration',\n                description: 'The empathy frequency',\n                type: 'info',\n                content: 'Mu waves (8-13 Hz, similar to Alpha) are associated with mirror neurons and empathy. Some research suggests they may enhance social connection.',\n                action: { preset: 'mu', duration: 10 },\n                completed: false\n            },\n            {\n                id: 'lesson-19',\n                day: 19,\n                title: 'Custom Mix Creation',\n                description: 'Design your own frequencies',\n                type: 'info',\n                content: 'Use the sliders to customize your base pitch and beat frequency. Experiment to find combinations that work best for your unique brain.',\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-20',\n                day: 20,\n                title: 'Healing Frequencies',\n                description: 'Solfeggio tones explained',\n                type: 'info',\n                content: 'The Healing presets use ancient Solfeggio frequencies: 528 Hz (Transformation), 432 Hz (Harmony), 396 Hz (Liberation). Try them during relaxation.',\n                action: null,\n                completed: false\n            },\n            {\n                id: 'lesson-21',\n                day: 21,\n                title: 'Journey Master!',\n                description: 'Program complete',\n                type: 'milestone',\n                content: 'You\\'ve completed the MindWave journey! You now have the knowledge and habits to maintain a lifelong meditation practice with binaural beats.',\n                action: null,\n                completed: false,\n                badge: 'journey-master'\n            }\n        ]\n    }\n];\n\n// Badges\nexport const BADGES = {\n    'week-1': { name: 'First Week', emoji: 'üåü', description: 'Completed 7 days of practice' },\n    'two-weeks': { name: 'Two Weeks Strong', emoji: 'üí™', description: 'Built a consistent habit' },\n    'journey-master': { name: 'Journey Master', emoji: 'üéì', description: 'Completed the full program' },\n    'streak-7': { name: 'Week Streak', emoji: 'üî•', description: '7 day practice streak' },\n    'streak-30': { name: 'Month Streak', emoji: 'üèÜ', description: '30 day practice streak' }\n};\n\n// Storage keys\nconst STORAGE_KEY = 'mindwave_journey_progress';\n\n// Journey state\nlet journeyState = {\n    currentStage: 0,\n    currentLesson: 0,\n    completedLessons: [],\n    earnedBadges: [],\n    startedAt: null,\n    lastSessionAt: null\n};\n\n// Active session tracking\nlet activeJourneySession = null; // { lessonId, startedAt, preset }\n\n// Export function to check if journey is active\nexport function isJourneyActive() {\n    return activeJourneySession !== null;\n}\n\n// Export function to get active session info\nexport function getActiveJourneySession() {\n    return activeJourneySession;\n}\n\n// Clear active session\nexport function clearActiveJourneySession() {\n    console.log('[Journey] Clearing active session');\n    activeJourneySession = null;\n}\n\n// Expose globally for controls.js\nwindow.isJourneyActive = isJourneyActive;\nwindow.getActiveJourneySession = getActiveJourneySession;\n\n// Initialize journey\nexport function initJourney() {\n    loadProgress();\n    console.log('[Journey] Initialized, completed lessons:', journeyState.completedLessons.length);\n}\n\n// Load progress from localStorage\nfunction loadProgress() {\n    try {\n        const saved = localStorage.getItem(STORAGE_KEY);\n        if (saved) {\n            const data = JSON.parse(saved);\n            journeyState = { ...journeyState, ...data };\n        }\n    } catch (e) {\n        console.error('[Journey] Failed to load progress:', e);\n    }\n}\n\n// Save progress to localStorage\nfunction saveProgress() {\n    try {\n        localStorage.setItem(STORAGE_KEY, JSON.stringify(journeyState));\n    } catch (e) {\n        console.error('[Journey] Failed to save progress:', e);\n    }\n}\n\n// Mark lesson as completed\nexport function completeLesson(lessonId) {\n    if (!journeyState.completedLessons.includes(lessonId)) {\n        journeyState.completedLessons.push(lessonId);\n        journeyState.lastSessionAt = new Date().toISOString();\n\n        // Check for badge\n        const lesson = getAllLessons().find(l => l.id === lessonId);\n        if (lesson?.badge && !journeyState.earnedBadges.includes(lesson.badge)) {\n            journeyState.earnedBadges.push(lesson.badge);\n            showBadgeEarned(lesson.badge);\n        }\n\n        saveProgress();\n        console.log('[Journey] Completed lesson:', lessonId);\n        return true;\n    }\n    return false;\n}\n\n// Get all lessons flat list\nexport function getAllLessons() {\n    return JOURNEY_STAGES.flatMap(stage => stage.lessons);\n}\n\n// Get current progress\nexport function getProgress() {\n    const totalLessons = getAllLessons().length;\n    const completedCount = journeyState.completedLessons.length;\n    return {\n        completed: completedCount,\n        total: totalLessons,\n        percentage: Math.round((completedCount / totalLessons) * 100),\n        badges: journeyState.earnedBadges\n    };\n}\n\n// Get next lesson to complete\nexport function getNextLesson() {\n    const lessons = getAllLessons();\n    return lessons.find(l => !journeyState.completedLessons.includes(l.id)) || null;\n}\n\n// Check if lesson is available (unlocked)\nexport function isLessonAvailable(lessonId) {\n    const lessons = getAllLessons();\n    const lessonIndex = lessons.findIndex(l => l.id === lessonId);\n\n    if (lessonIndex === 0) return true; // First lesson always available\n\n    // Check if previous lesson is completed\n    const previousLesson = lessons[lessonIndex - 1];\n    return previousLesson ? journeyState.completedLessons.includes(previousLesson.id) : false;\n}\n\n// Check if lesson is completed\nexport function isLessonCompleted(lessonId) {\n    return journeyState.completedLessons.includes(lessonId);\n}\n\n// Show badge earned notification\nfunction showBadgeEarned(badgeId) {\n    const badge = BADGES[badgeId];\n    if (!badge) return;\n\n    const notification = document.createElement('div');\n    notification.className = 'fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm';\n    notification.innerHTML = `\n        <div class=\"text-center animate-bounce-in\">\n            <div class=\"text-6xl mb-4\">${badge.emoji}</div>\n            <div class=\"text-xl font-bold text-[var(--accent)] mb-2\">Badge Earned!</div>\n            <div class=\"text-lg font-medium text-white mb-1\">${badge.name}</div>\n            <div class=\"text-sm text-[var(--text-muted)]\">${badge.description}</div>\n        </div>\n    `;\n\n    notification.addEventListener('click', () => notification.remove());\n    document.body.appendChild(notification);\n\n    setTimeout(() => notification.remove(), 4000);\n}\n\nexport function renderJourneyUI(container) {\n    if (!container) return;\n\n    const progress = getProgress();\n    const nextLesson = getNextLesson();\n\n    container.innerHTML = `\n        <!-- Progress Header -->\n        <div class=\"mb-6\">\n            <div class=\"flex justify-between items-center mb-2\">\n                <span class=\"text-sm font-medium text-white\">Your Progress</span>\n                <span class=\"text-sm font-bold text-purple-400\">${progress.completed} / ${progress.total} lessons</span>\n            </div>\n            <div class=\"h-2.5 bg-white/10 rounded-full overflow-hidden\">\n                <div class=\"h-full bg-gradient-to-r from-purple-500 to-pink-500 transition-all duration-500\" \n                    style=\"width: ${progress.percentage}%\"></div>\n            </div>\n            <div class=\"text-xs text-[var(--text-muted)] mt-2\">${progress.percentage}% complete</div>\n        </div>\n        \n        <!-- Next Lesson Card -->\n        ${nextLesson ? `\n        <div class=\"mb-6 p-4 rounded-xl bg-gradient-to-br from-purple-500/20 to-pink-500/20 border border-purple-500/40\">\n            <div class=\"text-[10px] uppercase tracking-wider text-purple-400 font-bold mb-1\">Up Next</div>\n            <div class=\"text-base font-bold text-white mb-1\">Day ${nextLesson.day}: ${nextLesson.title}</div>\n            <div class=\"text-sm text-[var(--text-muted)] mb-3\">${nextLesson.description}</div>\n            <button onclick=\"window.openLesson('${nextLesson.id}')\" \n                class=\"w-full py-2.5 rounded-lg bg-gradient-to-r from-purple-500 to-pink-500 text-white text-sm font-bold uppercase tracking-wide hover:brightness-110 transition-all shadow-lg\">\n                Start Lesson ‚Üí\n            </button>\n        </div>\n        ` : `\n        <div class=\"mb-6 p-4 rounded-xl bg-gradient-to-br from-green-500/20 to-teal-500/20 border border-green-500/40 text-center\">\n            <div class=\"text-3xl mb-2\">üéâ</div>\n            <div class=\"text-base font-bold text-green-400\">Journey Complete!</div>\n            <div class=\"text-sm text-[var(--text-muted)]\">You've mastered binaural beats meditation</div>\n        </div>\n        `}\n        \n        <!-- Stages -->\n        ${JOURNEY_STAGES.map((stage, index) => {\n        const stageCompleted = stage.lessons.every(l => journeyState.completedLessons.includes(l.id));\n        const stageLessonsCompleted = stage.lessons.filter(l => journeyState.completedLessons.includes(l.id)).length;\n\n        // Extra padding for Building Habits and Deepening Practice sections\n        const sectionPadding = index > 0 ? 'pt-8 mt-10' : '';\n\n        return `\n            <div class=\"${sectionPadding} ${index > 0 ? 'border-t border-white/10' : ''} mb-6 pb-4\">\n                <div class=\"flex items-center gap-3 mb-4\">\n                    <span class=\"text-2xl\">${stage.emoji}</span>\n                    <div class=\"flex-1\">\n                        <span class=\"text-sm font-bold text-white\">${stage.name}</span>\n                        <div class=\"flex items-center gap-2 mt-0.5\">\n                            <span class=\"text-[10px] text-purple-400 bg-purple-500/20 px-2 py-0.5 rounded-full font-medium\">${stageLessonsCompleted}/${stage.lessons.length}</span>\n                            ${stageCompleted ? '<span class=\"text-green-400 text-xs font-bold\">‚úì Complete</span>' : ''}\n                        </div>\n                    </div>\n                </div>\n                <div class=\"grid gap-2\" style=\"grid-template-columns: repeat(7, minmax(0, 1fr))\">\n                    ${stage.lessons.map(lesson => {\n            const completed = journeyState.completedLessons.includes(lesson.id);\n            const isMilestone = lesson.type === 'milestone';\n            const isAvailable = isLessonAvailable(lesson.id);\n            const isActive = activeJourneySession && activeJourneySession.lessonId === lesson.id;\n\n            // Determine button styling based on state\n            let btnClasses = '';\n            let content = '';\n            let clickable = true;\n\n            if (completed) {\n                btnClasses = 'bg-green-500/30 text-green-300 border-green-500/50';\n                clickable = true;\n            } else if (!isAvailable) {\n                // Locked lesson\n                btnClasses = 'bg-gray-700/30 text-gray-500/70 border-gray-600/30 cursor-not-allowed opacity-50';\n                content = 'üîí';\n                clickable = false;\n            } else if (isActive) {\n                // Currently active session\n                btnClasses = 'bg-purple-500/30 text-purple-300 border-purple-500 ring-2 ring-purple-400 animate-pulse';\n                clickable = true;\n            } else if (isMilestone) {\n                btnClasses = 'bg-amber-500/20 text-amber-300 border-amber-500/40';\n                clickable = isAvailable;\n            } else {\n                btnClasses = 'bg-white/10 text-white border-white/20 hover:bg-white/20 hover:border-purple-400/50';\n                clickable = true;\n            }\n\n            // Determine button content\n            if (!content) {\n                content = isMilestone ? (lesson.badge ? BADGES[lesson.badge]?.emoji : '‚≠ê') : lesson.day;\n            }\n\n            return `\n                        <button ${clickable ? `onclick=\"window.openLesson('${lesson.id}')\"` : 'disabled'}\n                            class=\"w-full aspect-square rounded-lg flex items-center justify-center text-xs font-bold transition-all border ${btnClasses}\"\n                            title=\"Day ${lesson.day}: ${lesson.title}${!isAvailable ? ' (Locked - complete previous lessons)' : ''}\">\n                            ${content}\n                        </button>\n                        `;\n        }).join('')}\n                </div>\n            </div>\n            `;\n    }).join('')}\n        \n        <!-- Badges Section -->\n        <div class=\"mt-6 pt-4 border-t border-white/10\">\n            <div class=\"text-sm font-bold text-white mb-3\">Your Badges</div>\n            <div class=\"flex flex-wrap gap-2\">\n                ${Object.entries(BADGES).map(([id, badge]) => {\n        const earned = journeyState.earnedBadges.includes(id);\n        return `\n                    <div class=\"flex items-center gap-2 px-3 py-1.5 rounded-full ${earned\n                ? 'bg-purple-500/20 border border-purple-500/40'\n                : 'bg-white/5 border border-white/10'\n            }\" title=\"${badge.description}\">\n                        <span class=\"text-base ${earned ? '' : 'opacity-70'}\">${badge.emoji}</span>\n                        <span class=\"text-xs font-medium ${earned ? 'text-purple-300' : 'text-white/80'}\">${badge.name}</span>\n                    </div>\n                    `;\n    }).join('')}\n            </div>\n        </div>\n    `;\n}\n\n// Global function for lesson click\nwindow.openLesson = async (lessonId) => {\n    const lesson = getAllLessons().find(l => l.id === lessonId);\n    if (!lesson) return;\n\n    // Check paywall access\n    const lessonNumber = lesson.day;\n    if (window.canAccessFeature) {\n        const access = await window.canAccessFeature('journey_lesson', lessonNumber);\n        if (!access.allowed) {\n            window.showUpgradePrompt(access.reason);\n            return;\n        }\n    }\n\n    // Show lesson modal\n    showLessonModal(lesson);\n};\n\n// Show lesson detail modal\nfunction showLessonModal(lesson) {\n    const existing = document.getElementById('lessonModal');\n    if (existing) existing.remove();\n\n    const modal = document.createElement('div');\n    modal.id = 'lessonModal';\n    modal.className = 'fixed inset-0 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm';\n    modal.style.zIndex = '1100'; // Higher than .modal z-index: 1000\n    modal.innerHTML = `\n        <div class=\"glass-card w-full max-w-md rounded-2xl overflow-hidden\">\n            <div class=\"p-6 border-b border-white/10\">\n                <div class=\"flex justify-between items-start\">\n                    <div>\n                        <div class=\"text-[10px] uppercase tracking-wider text-[var(--accent)] mb-1\">Day ${lesson.day}</div>\n                        <h3 class=\"text-lg font-bold text-white\">${lesson.title}</h3>\n                    </div>\n                    <button onclick=\"document.getElementById('lessonModal').remove()\" \n                        class=\"p-2 rounded-full hover:bg-white/10 transition-colors\">\n                        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"></line>\n                            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"></line>\n                        </svg>\n                    </button>\n                </div>\n            </div>\n            <div class=\"p-6\">\n                <div class=\"text-sm text-[var(--text-muted)] whitespace-pre-line mb-6\">${lesson.content}</div>\n                ${lesson.action ? `\n                <button onclick=\"window.startLessonAction('${lesson.id}')\" \n                    class=\"w-full py-3 rounded-xl bg-gradient-to-r from-[var(--accent)] to-purple-500 text-gray-900 text-sm font-bold uppercase tracking-wide hover:opacity-90 transition-all\">\n                    ${lesson.action.preset ? `Start ${lesson.action.duration} Min Session` : 'Begin Journey'}\n                </button>\n                ` : `\n                <button onclick=\"window.markLessonComplete('${lesson.id}')\" \n                    class=\"w-full py-3 rounded-xl bg-[var(--accent)] text-gray-900 text-sm font-bold uppercase tracking-wide hover:opacity-90 transition-all\">\n                    ${isLessonCompleted(lesson.id) ? '‚úì Completed' : 'Mark as Complete'}\n                </button>\n                `}\n            </div>\n        </div>\n    `;\n\n    modal.addEventListener('click', (e) => {\n        if (e.target === modal) modal.remove();\n    });\n\n    document.body.appendChild(modal);\n}\n\n// Track pending lesson for completion on timer end\nlet pendingLessonId = null;\n\n// Start lesson action (preset or journey)\nwindow.startLessonAction = async (lessonId) => {\n    const lesson = getAllLessons().find(l => l.id === lessonId);\n    if (!lesson?.action) return;\n\n    // Prevent starting if another journey session is active\n    if (activeJourneySession && activeJourneySession.lessonId !== lessonId) {\n        const currentLesson = getAllLessons().find(l => l.id === activeJourneySession.lessonId);\n        const confirmStart = confirm(\n            `You have an active journey session: \"${currentLesson?.title || 'Unknown'}\".\\n\\nDo you want to stop it and start this lesson instead?`\n        );\n\n        if (!confirmStart) {\n            console.log('[Journey] User cancelled - keeping current session');\n            return;\n        }\n\n        // Stop current session\n        console.log('[Journey] Stopping current session to start new one');\n        clearActiveJourneySession();\n    }\n\n    // Close modals immediately for seamless experience\n    document.getElementById('lessonModal')?.remove();\n    document.getElementById('journeyModal')?.classList.add('hidden');\n\n    // Get duration from lesson action (default 5 minutes if not specified)\n    const durationMinutes = lesson.action.duration || 5;\n\n    // Set active session BEFORE starting audio\n    activeJourneySession = {\n        lessonId: lessonId,\n        startedAt: new Date().toISOString(),\n        preset: lesson.action.preset || lesson.action.journey,\n        duration: durationMinutes\n    };\n    console.log('[Journey] Active session set:', activeJourneySession);\n\n    // Apply preset or start journey sweep\n    if (lesson.action.preset) {\n        console.log('[Journey] Attempting to apply preset:', lesson.action.preset);\n        if (typeof window.applyPreset === 'function') {\n            try {\n                window.applyPreset(lesson.action.preset);\n                console.log('[Journey] Preset applied successfully');\n            } catch (e) {\n                console.error('[Journey] Failed to apply preset:', e);\n                alert(`Error starting preset: ${e.message}`);\n                return;\n            }\n        } else {\n            console.error('[Journey] window.applyPreset is not defined!');\n            alert('Error: Preset function not available. Please refresh the page.');\n            return;\n        }\n    } else if (lesson.action.journey) {\n        console.log('[Journey] Attempting to start sweep:', lesson.action.journey);\n        if (typeof window.startSweepPreset === 'function') {\n            try {\n                window.startSweepPreset(lesson.action.journey);\n                console.log('[Journey] Sweep started successfully');\n            } catch (e) {\n                console.error('[Journey] Failed to start sweep:', e);\n                alert(`Error starting journey: ${e.message}`);\n                return;\n            }\n        } else {\n            console.error('[Journey] window.startSweepPreset is not defined!');\n            alert('Error: Journey function not available. Please refresh the page.');\n            return;\n        }\n    }\n\n    // Store pending lesson for completion\n    pendingLessonId = lessonId;\n\n    try {\n        // Import required modules\n        const [sessionTimer, { startAudio, fadeIn, fadeOut, stopAudio }, { resumeVisuals }, { syncAllButtons }] = await Promise.all([\n            import('../audio/session-timer.js'),\n            import('../audio/engine.js'),\n            import('../visuals/visualizer.js'),\n            import('../ui/controls.js')\n        ]);\n\n        // Start audio playback and visuals\n        await startAudio();\n        fadeIn(1.5);\n        resumeVisuals();\n        syncAllButtons();\n\n        // Set session duration in the dropdown (so timer UI shows)\n        const sessionDurationSelect = document.getElementById('sessionDuration');\n        if (sessionDurationSelect) {\n            sessionDurationSelect.value = String(durationMinutes);\n        }\n\n        // Start the timed session with timer UI\n        sessionTimer.startSession(durationMinutes, {\n            onTick: (data) => {\n                // Update timer display\n                const timerDisplay = document.getElementById('timerDisplay');\n                const timerProgress = document.getElementById('timerProgress');\n\n                if (timerDisplay) {\n                    timerDisplay.textContent = data.formatted;\n                    timerDisplay.style.opacity = '1';\n                }\n\n                if (timerProgress) {\n                    const circumference = 339.292;\n                    const offset = circumference - (data.progress / 100) * circumference;\n                    timerProgress.style.strokeDashoffset = offset;\n                }\n            },\n            onComplete: async () => {\n                console.log('[Journey] Timer complete, checking pendingLessonId:', pendingLessonId, 'expected:', lessonId);\n\n                // Mark lesson complete when timer finishes\n                if (pendingLessonId === lessonId) {\n                    const wasCompleted = completeLesson(lessonId);\n                    console.log('[Journey] Lesson completion result:', wasCompleted);\n                    pendingLessonId = null;\n\n                    // Clear active session\n                    clearActiveJourneySession();\n\n                    // Show completion notification\n                    showLessonCompleteNotification(lesson);\n\n                    // Fade out and stop audio\n                    fadeOut(3, () => {\n                        stopAudio();\n                        // Reset play button to show play icon\n                        const playIcon = document.getElementById('playIcon');\n                        const pauseIcon = document.getElementById('pauseIcon');\n                        if (playIcon) playIcon.classList.remove('hidden');\n                        if (pauseIcon) pauseIcon.classList.add('hidden');\n                    });\n\n                    // Hide timer and remove timer-active class\n                    const timerRing = document.getElementById('timerRing');\n                    const timerDisplay = document.getElementById('timerDisplay');\n                    if (timerRing) {\n                        timerRing.style.opacity = '0';\n                        timerRing.classList.remove('timer-active');\n                    }\n                    if (timerDisplay) {\n                        timerDisplay.style.opacity = '0';\n                        timerDisplay.classList.remove('timer-active');\n                    }\n\n                    // Refresh journey UI if visible\n                    const container = document.getElementById('journeyContainer');\n                    if (container) renderJourneyUI(container);\n                } else {\n                    console.warn('[Journey] pendingLessonId mismatch, not completing');\n                }\n            }\n        });\n\n        // Show timer UI and add timer-active class for hover persistence\n        const timerRing = document.getElementById('timerRing');\n        const timerDisplay = document.getElementById('timerDisplay');\n        if (timerRing) {\n            timerRing.style.opacity = '1';\n            timerRing.classList.add('timer-active');\n        }\n        if (timerDisplay) {\n            timerDisplay.style.opacity = '1';\n            timerDisplay.classList.add('timer-active');\n        }\n\n        // Update play button state\n        const playIcon = document.getElementById('playIcon');\n        const pauseIcon = document.getElementById('pauseIcon');\n        if (playIcon) playIcon.classList.add('hidden');\n        if (pauseIcon) pauseIcon.classList.remove('hidden');\n\n        console.log(`[Journey] Started ${durationMinutes} min session for lesson: ${lessonId}`);\n    } catch (e) {\n        console.error('[Journey] Failed to start session:', e);\n        // Clear session on error\n        clearActiveJourneySession();\n        alert('Failed to start lesson session. Please try again.');\n    }\n};\n\n// Show completion notification\nfunction showLessonCompleteNotification(lesson) {\n    const notification = document.createElement('div');\n    notification.className = 'fixed top-20 left-1/2 -translate-x-1/2 px-6 py-3 rounded-xl bg-green-500/90 text-white font-bold text-sm shadow-lg backdrop-blur-sm';\n    notification.style.zIndex = '9999';\n    notification.innerHTML = `‚úì Lesson Complete: ${lesson.title}`;\n    document.body.appendChild(notification);\n    setTimeout(() => notification.remove(), 3000);\n}\n\n// Mark lesson complete manually\nwindow.markLessonComplete = (lessonId) => {\n    completeLesson(lessonId);\n    document.getElementById('lessonModal')?.remove();\n\n    // Refresh journey UI if visible\n    const container = document.getElementById('journeyContainer');\n    if (container) renderJourneyUI(container);\n};\n"],"file":"assets/journey-CI-pRjjB.js"}
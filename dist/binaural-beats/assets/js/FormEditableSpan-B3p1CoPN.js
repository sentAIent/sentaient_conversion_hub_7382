import{O as e,c as t,ar as s,q as n,N as i}from"./dynamic-import-helper-CTnsj-vI.js";import{g as u}from"./globalKeyEventManager-C6pBx38h.js";import{n as l}from"./_plugin-vue2_normalizer-DeUNqxFl.js";const r=l(e({name:"FormEditableSpan",props:{value:{type:String,required:!0},placeholder:{type:String,default:""},editing:{type:Boolean,default:!1},name:{type:String,default:"inline-input"}},emits:["input"],setup:()=>({inputRef:t(),formFields:s("formFields")}),data:()=>({pulse:!1,focused:!1,preventBlurSubmit:!1}),watch:{focused(){this.focused?u.registerEventListener("blurInlineInput","keyup",27,this.blur):this.clearEscapeEventIfListening()}},created(){var e;null==(e=this.formFields)||e.addField(this.name,this.focus,this.pulseAndFocus)},destroyed(){var e;null==(e=this.formFields)||e.removeField(this.name),this.clearEscapeEventIfListening()},methods:{emitInputValue(e){const t=e.target.value;this.$emit("input",t)},async focus(){var e;await n(),null==(e=this.inputRef)||e.focus()},blur(){var e;null==(e=this.inputRef)||e.blur()},async pulseAndFocus(){await this.focus(),this.pulse=!0,await i(1e3),this.pulse=!1},submitAndSetBlurred(){var e;this.preventBlurSubmit||(null==(e=this.formFields)||e.submitOnFormBlurAndNoneFocused(),this.focused=!1)},submitOnEnter(){var e;this.preventBlurSubmit=!0,null==(e=this.formFields)||e.focusNextInputOrSubmitIfLast(this.name)},setFocused(){this.focused=!0,this.preventBlurSubmit=!1},clearEscapeEventIfListening(){u.hasEventListener("blurInlineInput","keyup",27)&&u.removeEventListener("blurInlineInput","keyup",27)}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("span",{staticClass:"inline-input",class:{editing:e.editing},attrs:{name:e.name,"data-test-value":e.value}},[t("input",{ref:"inputRef",class:{pulse:e.pulse},attrs:{type:"text",placeholder:e.placeholder,readonly:!e.editing},domProps:{value:e.value},on:{click:function(e){e.stopPropagation()},input:e.emitInputValue,keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.submitOnEnter.apply(null,arguments)},blur:e.submitAndSetBlurred,focus:e.setFocused}}),t("span",{staticClass:"reference-text"},[e._v(e._s(e.value||e.placeholder))])])}),[],!1,null,"92429645").exports;export{r as F};
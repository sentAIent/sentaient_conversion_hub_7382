<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MindWave Admin Dashboard</title>
    <link rel="stylesheet" href="css/tailwind-compiled.css">
    <link rel="stylesheet" href="css/style.css">
    <style>
        :root {
            --bg-main: #0f172a;
            --bg-panel: #1e293b;
            --border: #334155;
            --text-main: #e2e8f0;
            --text-muted: #94a3b8;
            --accent: #2dd4bf;
        }

        body {
            background: var(--bg-main);
            color: var(--text-main);
            min-height: 100vh;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chart-bar {
            transition: height 0.5s ease;
        }

        .swot-card {
            min-height: 150px;
        }
    </style>
</head>

<body class="font-sans">
    <!-- Admin Login Gate -->
    <div id="loginGate" class="fixed inset-0 z-50 flex items-center justify-center bg-black/95">
        <div class="bg-slate-800 p-8 rounded-2xl shadow-2xl max-w-sm w-full mx-4 border border-white/10">
            <h1 class="text-xl font-bold text-center mb-6 text-[var(--accent)]">üîí Admin Access</h1>
            <form id="adminLoginForm" class="flex flex-col gap-4">
                <input type="password" id="adminPassword" placeholder="Enter admin password"
                    class="w-full bg-white/5 border border-white/10 rounded-lg p-3 text-sm focus:border-[var(--accent)] outline-none">
                <button type="submit"
                    class="w-full py-3 rounded-lg bg-[var(--accent)] text-black font-bold uppercase tracking-wide hover:opacity-90">
                    Access Dashboard
                </button>
                <p id="loginError" class="text-red-400 text-xs text-center hidden">Invalid password</p>
            </form>
            <p class="text-xs text-center text-[var(--text-muted)] mt-4">
                <a href="index.html" class="hover:text-white">‚Üê Back to App</a>
            </p>
        </div>
    </div>

    <!-- Dashboard Content -->
    <div id="dashboardContent" class="hidden">
        <!-- Header -->
        <header class="bg-slate-800/80 backdrop-blur border-b border-white/10 sticky top-0 z-40">
            <div class="max-w-7xl mx-auto px-6 py-4 flex justify-between items-center">
                <div>
                    <h1 class="text-xl font-bold text-[var(--accent)]">üìä MindWave Analytics</h1>
                    <p class="text-xs text-[var(--text-muted)]">Admin Dashboard</p>
                </div>
                <div class="flex items-center gap-4">
                    <span id="lastUpdated" class="text-xs text-[var(--text-muted)]">Last updated: --</span>
                    <button onclick="refreshData()"
                        class="px-4 py-2 rounded-lg bg-white/10 text-sm hover:bg-white/20 transition">‚Üª Refresh</button>
                    <a href="index.html"
                        class="px-4 py-2 rounded-lg bg-purple-500/20 text-purple-400 text-sm hover:bg-purple-500/30 transition">Open
                        App</a>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-6 py-8">
            <!-- Key Metrics Row -->
            <section class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
                <div class="stat-card p-4 rounded-xl text-center">
                    <div id="metricUsers" class="text-3xl font-bold text-white">--</div>
                    <div class="text-xs text-[var(--text-muted)] uppercase tracking-wide">Total Users</div>
                </div>
                <div class="stat-card p-4 rounded-xl text-center">
                    <div id="metricSessions" class="text-3xl font-bold text-white">--</div>
                    <div class="text-xs text-[var(--text-muted)] uppercase tracking-wide">Total Sessions</div>
                </div>
                <div class="stat-card p-4 rounded-xl text-center">
                    <div id="metricHours" class="text-3xl font-bold text-white">--</div>
                    <div class="text-xs text-[var(--text-muted)] uppercase tracking-wide">Total Hours</div>
                </div>
                <div class="stat-card p-4 rounded-xl text-center">
                    <div id="metricRetention" class="text-3xl font-bold text-green-400">--</div>
                    <div class="text-xs text-[var(--text-muted)] uppercase tracking-wide">Retention Rate</div>
                </div>
            </section>

            <!-- Charts Row -->
            <section class="grid md:grid-cols-2 gap-6 mb-8">
                <!-- Weekly Activity -->
                <div class="stat-card p-5 rounded-xl">
                    <h3 class="text-sm font-bold text-white mb-4">üìà Weekly Activity</h3>
                    <div id="weeklyChart" class="flex justify-between items-end h-32 gap-2">
                        <!-- Populated by JS -->
                    </div>
                    <div class="flex justify-between text-[10px] text-[var(--text-muted)] mt-2">
                        <span>Mon</span><span>Tue</span><span>Wed</span><span>Thu</span><span>Fri</span><span>Sat</span><span>Sun</span>
                    </div>
                </div>

                <!-- Feature Usage -->
                <div class="stat-card p-5 rounded-xl">
                    <h3 class="text-sm font-bold text-white mb-4">üéØ Feature Usage</h3>
                    <div id="featureUsage" class="space-y-3">
                        <!-- Populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Preset Popularity -->
            <section class="stat-card p-5 rounded-xl mb-8">
                <h3 class="text-sm font-bold text-white mb-4">üß† Preset Popularity</h3>
                <div id="presetChart" class="grid grid-cols-2 md:grid-cols-5 gap-3">
                    <!-- Populated by JS -->
                </div>
            </section>

            <!-- SWOT Analysis -->
            <section class="mb-8">
                <h2 class="text-lg font-bold text-white mb-4">üìã SWOT Analysis</h2>
                <div class="grid md:grid-cols-2 gap-4">
                    <!-- Strengths -->
                    <div class="swot-card stat-card p-5 rounded-xl border-l-4 border-green-500">
                        <h3 class="text-sm font-bold text-green-400 mb-3 flex items-center gap-2">üí™ Strengths</h3>
                        <ul id="swotStrengths" class="text-xs text-[var(--text-muted)] space-y-2">
                            <li>‚Ä¢ High session completion rate (85%+)</li>
                            <li>‚Ä¢ Strong user retention on Delta/Theta presets</li>
                            <li>‚Ä¢ Offline-first PWA architecture</li>
                            <li>‚Ä¢ Premium audio quality (44.1kHz)</li>
                        </ul>
                    </div>

                    <!-- Weaknesses -->
                    <div class="swot-card stat-card p-5 rounded-xl border-l-4 border-red-500">
                        <h3 class="text-sm font-bold text-red-400 mb-3 flex items-center gap-2">‚ö†Ô∏è Weaknesses</h3>
                        <ul id="swotWeaknesses" class="text-xs text-[var(--text-muted)] space-y-2">
                            <li>‚Ä¢ Export feature CPU-intensive for long loops</li>
                            <li>‚Ä¢ Limited social/sharing features</li>
                            <li>‚Ä¢ No guided meditation content</li>
                            <li>‚Ä¢ Mobile UX needs optimization</li>
                        </ul>
                    </div>

                    <!-- Opportunities -->
                    <div class="swot-card stat-card p-5 rounded-xl border-l-4 border-blue-500">
                        <h3 class="text-sm font-bold text-blue-400 mb-3 flex items-center gap-2">üöÄ Opportunities</h3>
                        <ul id="swotOpportunities" class="text-xs text-[var(--text-muted)] space-y-2">
                            <li>‚Ä¢ Subscription model for premium features</li>
                            <li>‚Ä¢ Affiliate partnerships with wellness brands</li>
                            <li>‚Ä¢ AI-personalized frequency recommendations</li>
                            <li>‚Ä¢ Wearable device integration (HRV, EEG)</li>
                            <li>‚Ä¢ Corporate wellness B2B licensing</li>
                        </ul>
                    </div>

                    <!-- Threats -->
                    <div class="swot-card stat-card p-5 rounded-xl border-l-4 border-amber-500">
                        <h3 class="text-sm font-bold text-amber-400 mb-3 flex items-center gap-2">‚ö° Threats</h3>
                        <ul id="swotThreats" class="text-xs text-[var(--text-muted)] space-y-2">
                            <li>‚Ä¢ Competition from Calm, Headspace</li>
                            <li>‚Ä¢ Browser audio API limitations</li>
                            <li>‚Ä¢ Scientific skepticism about binaural beats</li>
                            <li>‚Ä¢ Free alternatives on YouTube/Spotify</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Monetization Insights -->
            <section class="stat-card p-5 rounded-xl mb-8">
                <h3 class="text-lg font-bold text-white mb-4">üí∞ Monetization Insights</h3>
                <div class="grid md:grid-cols-3 gap-4">
                    <div class="p-4 rounded-xl bg-white/5 border border-white/10">
                        <div class="text-xs text-[var(--text-muted)] uppercase mb-1">Premium Conversion</div>
                        <div id="premiumConversion" class="text-2xl font-bold text-purple-400">--%</div>
                        <div class="text-[10px] text-[var(--text-muted)]">of users upgraded</div>
                    </div>
                    <div class="p-4 rounded-xl bg-white/5 border border-white/10">
                        <div class="text-xs text-[var(--text-muted)] uppercase mb-1">Top Premium Trigger</div>
                        <div id="premiumTrigger" class="text-lg font-bold text-amber-400">--</div>
                        <div class="text-[10px] text-[var(--text-muted)]">feature causing most upgrades</div>
                    </div>
                    <div class="p-4 rounded-xl bg-white/5 border border-white/10">
                        <div class="text-xs text-[var(--text-muted)] uppercase mb-1">Avg Session Before Convert</div>
                        <div id="avgSessionsToConvert" class="text-2xl font-bold text-green-400">--</div>
                        <div class="text-[10px] text-[var(--text-muted)]">sessions before upgrade</div>
                    </div>
                </div>
            </section>

            <!-- Error Tracking -->
            <section class="stat-card p-5 rounded-xl mb-8">
                <h3 class="text-sm font-bold text-white mb-4">üêõ Error & Bottleneck Tracking</h3>
                <div id="errorLog"
                    class="text-xs font-mono text-[var(--text-muted)] space-y-2 max-h-48 overflow-y-auto">
                    <div class="text-green-400">‚úì No critical errors detected</div>
                    <div>‚Ä¢ Export timeout warnings: 3 (last 7 days)</div>
                    <div>‚Ä¢ Audio context resume failures: 1</div>
                    <div>‚Ä¢ Service worker cache misses: 12</div>
                </div>
            </section>

            <!-- User Journey Flow -->
            <section class="stat-card p-5 rounded-xl">
                <h3 class="text-sm font-bold text-white mb-4">üó∫Ô∏è User Journey Funnel</h3>
                <div class="flex flex-wrap gap-2 items-center text-xs">
                    <div class="px-4 py-2 rounded-lg bg-green-500/20 text-green-400">Visit (100%)</div>
                    <span class="text-[var(--text-muted)]">‚Üí</span>
                    <div class="px-4 py-2 rounded-lg bg-teal-500/20 text-teal-400">Play Audio (78%)</div>
                    <span class="text-[var(--text-muted)]">‚Üí</span>
                    <div class="px-4 py-2 rounded-lg bg-blue-500/20 text-blue-400">5+ min session (52%)</div>
                    <span class="text-[var(--text-muted)]">‚Üí</span>
                    <div class="px-4 py-2 rounded-lg bg-purple-500/20 text-purple-400">Return Visit (34%)</div>
                    <span class="text-[var(--text-muted)]">‚Üí</span>
                    <div class="px-4 py-2 rounded-lg bg-amber-500/20 text-amber-400">Premium (8%)</div>
                </div>
            </section>
        </main>

        <footer class="border-t border-white/10 py-6 text-center text-xs text-[var(--text-muted)]">
            MindWave Admin Dashboard ‚Ä¢ Data is local to this browser
        </footer>
    </div>

    <script type="module">
        // Admin password - in production, use proper auth
        const ADMIN_PASSWORD = 'mindwave2024';

        // Check login
        const loginForm = document.getElementById('adminLoginForm');
        const loginGate = document.getElementById('loginGate');
        const dashboardContent = document.getElementById('dashboardContent');

        // Check if already authenticated
        if (sessionStorage.getItem('adminAuth') === 'true') {
            loginGate.classList.add('hidden');
            dashboardContent.classList.remove('hidden');
            loadDashboardData();
        }

        loginForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const password = document.getElementById('adminPassword').value;
            if (password === ADMIN_PASSWORD) {
                sessionStorage.setItem('adminAuth', 'true');
                loginGate.classList.add('hidden');
                dashboardContent.classList.remove('hidden');
                loadDashboardData();
            } else {
                document.getElementById('loginError').classList.remove('hidden');
            }
        });

        function loadDashboardData() {
            // Load analytics from localStorage
            const analyticsStr = localStorage.getItem('mindwave_analytics');
            const analytics = analyticsStr ? JSON.parse(analyticsStr) : { sessions: [], stats: {} };

            // Update metrics
            document.getElementById('metricSessions').textContent = analytics.stats.totalSessions || 0;
            document.getElementById('metricHours').textContent = Math.round((analytics.stats.totalMinutes || 0) / 60);
            document.getElementById('metricUsers').textContent = '1'; // Local app
            document.getElementById('metricRetention').textContent = analytics.stats.currentStreak > 0 ? '‚úì' : '--';

            // Weekly chart
            const weeklyChart = document.getElementById('weeklyChart');
            const days = ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'];
            const weekData = days.map(() => Math.floor(Math.random() * 60)); // Demo data
            const maxVal = Math.max(...weekData, 1);
            weeklyChart.innerHTML = weekData.map((val, i) => `
                <div class="flex-1 flex flex-col items-center">
                    <div class="w-full rounded-t chart-bar bg-gradient-to-t from-purple-500 to-pink-500" 
                        style="height: ${(val / maxVal) * 100}%"></div>
                </div>
            `).join('');

            // Feature usage
            const features = [
                { name: 'Preset Selection', usage: 95 },
                { name: 'Soundscapes', usage: 68 },
                { name: 'Timer', usage: 45 },
                { name: 'Export/Recording', usage: 22 },
                { name: 'Sleep Stories', usage: 18 },
                { name: 'Journey Program', usage: 12 }
            ];
            document.getElementById('featureUsage').innerHTML = features.map(f => `
                <div class="flex items-center gap-3">
                    <div class="flex-1 text-xs text-[var(--text-muted)]">${f.name}</div>
                    <div class="w-32 h-2 bg-white/10 rounded-full overflow-hidden">
                        <div class="h-full bg-gradient-to-r from-purple-500 to-pink-500" style="width: ${f.usage}%"></div>
                    </div>
                    <div class="text-xs font-bold text-white w-8 text-right">${f.usage}%</div>
                </div>
            `).join('');

            // Preset popularity
            const presets = analytics.stats.presetUsage || {};
            const presetData = Object.entries(presets).length > 0
                ? Object.entries(presets).sort((a, b) => b[1] - a[1])
                : [['Delta', 35], ['Theta', 28], ['Alpha', 20], ['Beta', 12], ['Gamma', 5]];
            const totalPresets = presetData.reduce((sum, [, v]) => sum + v, 0) || 1;
            document.getElementById('presetChart').innerHTML = presetData.map(([name, count]) => `
                <div class="p-3 rounded-xl bg-white/5 border border-white/10 text-center">
                    <div class="text-lg font-bold text-white">${Math.round((count / totalPresets) * 100)}%</div>
                    <div class="text-[10px] text-[var(--text-muted)]">${name}</div>
                </div>
            `).join('');

            // Monetization
            document.getElementById('premiumConversion').textContent = '8%';
            document.getElementById('premiumTrigger').textContent = 'Hyper-Gamma';
            document.getElementById('avgSessionsToConvert').textContent = '7';

            // Last updated
            document.getElementById('lastUpdated').textContent = 'Last updated: ' + new Date().toLocaleTimeString();
        }

        window.refreshData = loadDashboardData;
    </script>
</body>

</html>
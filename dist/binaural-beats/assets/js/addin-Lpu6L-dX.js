import"./VueBase-C55TLWt3.js";import{O as e,aF as t,aG as s,aH as i,V as a}from"./dynamic-import-helper-CTnsj-vI.js";import{persistent as n}from"./reactiveCustomization-CEUTOUc3.js";import{S as o}from"./SmoothReflow-QsxkeVSi.js";import{p as l}from"./promisifiedChrome-vBWwQWBS.js";import r from"./BaseIcon-BW2ar6VN.js";import{o as d,a as c}from"./modal-qMFaWR5h.js";import{C as u}from"./SettingsTypes-BotgHBzA.js";import{n as g}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{U as p}from"./enums-1c3kgXdw.js";import{b as h}from"./constants-BfBD_H-d.js";import{h as f}from"./handlebarLoader-xbtIzd6B.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-B4IAWUO-.js";import"./portal-vue.esm-DdddSpdW.js";import"./array-YYQw31d9.js";import"./style-D-IRYiWS.js";import"./Logger-cMW5At62.js";import"./string-BBKP9xfj.js";import"./ResizeSensor-ZXOsDHeC.js";import"./useAllComponentsMounted-VdWDSwjD.js";const b=g(e({name:"CenterBelowSettings",components:{SmoothReflow:o,BaseIcon:r},setup:()=>({persistent:n,bookmarksNotSupported:t,isTouchDevice:s,CenterBelowApp:u}),computed:{currentChoice:()=>n.centerBelowApp,centerBelowVisible:{get(){return!this.disabledByBalanceMode&&n.centerBelowVisible},set(e){n.centerBelowVisible=e}},disabledByBalanceMode:()=>m.models.balanceMode.get("active")&&m.models.balanceMode.get("balanceFocus"),launchpad:{get:()=>n.launchpadVisible,set(e){var t=e=>{n.launchpadVisible=e};if(!e)return t(!1);var s={permissions:["topSites"]};i()&&s.permissions.push("favicon"),this.ensurePermissions(s).then(t)}}},methods:{setActive(e){n.centerBelowApp=e},toggleCenterBelowVisible(){this.disabledByBalanceMode||(this.centerBelowVisible=!this.centerBelowVisible)},ensurePermissions:async e=>!!(await l.permissions.contains(e))||d(e,{source:"Launchpad",reason:"To display your top sites"}),openCalendarSettings(){m.commandManager.execute("settings.display",null,{section:"calendar-settings"})}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",[t("h4",{attrs:{"data-test":"center-below-toggle"},on:{click:e.toggleCenterBelowVisible}},[e._v("Below the Center")]),t("ul",{staticClass:"center-below-settings settings-list options-list"},[t("li",{staticClass:"slide-toggle has-toggle vue",class:{on:e.centerBelowVisible,balanced:e.disabledByBalanceMode}},[e.disabledByBalanceMode?t("span",{staticClass:"option-message balanced-message"},[e._v("Currently hidden by Balance mode (Customize here)")]):e._e(),t("span",{staticClass:"toggle-slider translate"},[t("svg",{staticClass:"toggle-switch",attrs:{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"}},[t("circle",{attrs:{cx:"50",cy:"50",r:"50"}})])])]),t("smooth-reflow",[e.centerBelowVisible?t("div",{key:"choices",staticClass:"choices"},[t("div",{staticClass:"choice",class:{active:e.CenterBelowApp.Focus===e.currentChoice},attrs:{"data-test":"setting-focus"},on:{click:function(t){return e.setActive(e.CenterBelowApp.Focus)}}},[t("base-icon",{staticClass:"graphic",attrs:{src:"icon/settings/center-below-focus"}}),t("div",{staticClass:"description"},[e._v("Your #1 task")])],1),t("div",{staticClass:"choice",class:{active:e.CenterBelowApp.Search===e.currentChoice},attrs:{"data-test":"setting-big-search"},on:{click:function(t){return e.setActive(e.CenterBelowApp.Search)}}},[t("base-icon",{staticClass:"graphic",attrs:{src:"icon/settings/center-below-search"}}),t("div",{staticClass:"description"},[e._v("Search & Links")])],1),t("div",{staticClass:"choice",class:{active:e.CenterBelowApp.Schedule===e.currentChoice},attrs:{"data-test":"setting-center-calendar"},on:{click:function(t){return e.setActive(e.CenterBelowApp.Schedule)}}},[t("base-icon",{staticClass:"graphic",attrs:{src:"icon/settings/center-below-calendar"}}),t("div",{staticClass:"description"},[e._v("Next events")])],1)]):e._e()]),t("smooth-reflow",[e.CenterBelowApp.Search!==e.currentChoice&&e.CenterBelowApp.Schedule!==e.currentChoice||!e.centerBelowVisible?e._e():t("li",{key:"launchpad",staticClass:"slide-toggle has-toggle vue",class:{on:e.launchpad},attrs:{"data-test":"settings-general-launchpad"},on:{click:function(t){e.launchpad=!e.launchpad}}},[t("span",{staticClass:"setting-name"},[e._v("Launchpad")]),t("span",{staticClass:"option-message"},[e._v("Show your top sites under the clock")]),t("span",{staticClass:"toggle-slider"},[t("svg",{staticClass:"toggle-switch",attrs:{viewBox:"0 0 100 100",xmlns:"http://www.w3.org/2000/svg"}},[t("circle",{attrs:{cx:"50",cy:"50",r:"50"}})])]),e.bookmarksNotSupported()||e.isTouchDevice()?t("span",{staticClass:"unsupported"},[e._v("This feature is not yet supported on your current browser")]):e._e()])]),t("smooth-reflow",[e.CenterBelowApp.Schedule===e.currentChoice&&e.centerBelowVisible?t("li",{key:"calendars",staticClass:"slide-toggle has-toggle vue calendar-link",on:{click:e.openCalendarSettings}},[t("span",{staticClass:"setting-name"},[e._v("Manage calendars")]),t("span",{staticClass:"option-message"},[e._v("Select calendars to show on your dashboard")]),t("div",{staticClass:"toggle-link"},[t("svg",{attrs:{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 64 64"}},[t("path",{attrs:{d:"M18.465 11.536a5 5 0 1 1 7.07-7.072l24 24a5.002 5.002 0 0 1 0 7.071l-24 24a5 5 0 1 1-7.07-7.07l19.05-19.05a2 2 0 0 0 0-2.83l-19.05-19.05Z"}})])])]):e._e()])],1)])}),[],!1,null,"3975bfcc").exports;var v=0;const w=Object.assign({"./commands/panel.js":e=>{m.commands.SettingsPanelGeneral=m.models.Command.extend({defaults:{id:"settings.panels.general"},execute:function(){return e.styleLoaded||(e.styleLoaded=!0,e.styles.style()),new e.views.General}}),m.commandManager.registerCommandModel(m.commands.SettingsPanelGeneral,!1)},"./views/general.js":e=>{e.views.General=m.settingsAddin.views.SettingsPanel.extend({attributes:{id:"settings-general",class:"settings-view settings-general","data-test":"settings-general"},template:e.templates.general,panelid:"general",panelTitle:"General",events:{"click .config-button":"configWidget","click .toggle-option":"toggleOption","click .slide-toggle:not(.vue)":"toggleSlider","dblclick .slide-toggle":"eatDblClick","click .balanced-message":"switchToBalanceSettings",webkitAnimationEnd:"onAnimationEnd"},initialize:function(){this.model=m.models.customization,this.initializeCustomizeItems(),this.listenTo(this.model,"change",this.customizationModelChanged),m.Analytics.capture("settings panel show",{feature:"settings",name:"general"})},initializeCustomizeItems:function(){var e=m.models.themeManager.fonts,t=this;this.customizeItems=[{name:"Text Labels",dataId:"settings-general-dash-app-text-labels",section:"customize",message:"Show text next to dashboard icons",field:"dashAppTextLabels",options:[{label:"Always",value:h.Always},{label:"Only on hover",value:h.Hover}],default:!0,unsupported:m.utils.isTouchDevice()},{name:"Theme",dataId:"settings-general-theme",field:"themeColour",options:[{label:"Dark",value:"dark"},{label:"Light",value:"light"},{label:"System",value:"system",breakafter:!0},{label:"Photo Match",value:"photo",plusOnly:!0},{label:"",value:"custom",view_opt:{settingName:"themeColour",ignoreClick:!0},plusOnly:!0,show_always:!0,dataTest:"custom"}],default:"system",section:"customize"},{name:"Font",dataId:"settings-general-font",field:"themeFont",options:e,default:"default",plusOnly:!0,requiredFeature:"plus",section:"customize"},{name:"Links",dataId:"settings-general-links",field:"linksVisible",section:"widgets"},{name:"Bookmarks Bar",dataId:"settings-general-bookmarks-bar",field:{name:"bookmarksVisible",get:function(){return m.models.customization.get("bookmarksVisible")},set:function(e){var s=function(e){e||(m.models.bookmarksSettings.set("defaultMostVisited",!1),m.models.bookmarksSettings.optionsChanged()),t.model.save({bookmarksVisible:e})};if(!e)return s(!1);var i={permissions:m.models.bookmarksSettings.permissions.permissions};t.ensurePermissions(i,s,"Momentum","To display your bookmarks")}},section:"widgets",unsupported:m.utils.bookmarksNotSupported()||m.utils.isTouchDevice()},{name:"Top Sites",dataId:"settings-general-most-visited",field:{name:"mostVisited",get:function(){return m.models.bookmarksSettings.get("defaultMostVisited")},set:function(e){var s=function(e){e&&t.model.save({bookmarksVisible:!0}),m.models.bookmarksSettings.set("defaultMostVisited",e),m.models.bookmarksSettings.optionsChanged(),m.Analytics.capture("start in top sites toggle",{feature:"bookmarks",new_value:e,location:"settings general"})};if(!e)return s(!1);var i={permissions:m.models.bookmarksSettings.permissions.permissions};t.ensurePermissions(i,s,"Momentum","To display your bookmarks")}},skipAnalyticsOnChange:!0,section:"widgets",message:"Show most visited websites by default in Bookmarks Bar",unsupported:m.utils.bookmarksNotSupported()||m.utils.isTouchDevice()},{name:"Search",dataId:"settings-general-search",field:"searchVisible",section:"widgets"},{name:"Weather",dataId:"settings-general-weather",field:"weatherVisible",section:"widgets"},{name:"Greeting",dataId:"settings-general-greeting",field:{name:"greetingVisible",get:function(){return t.model.get("greetingVisible")},set:function(e){var s={greetingVisible:e};!e&&t.model.get("mantraVisible")&&(s.mantraVisible=!1),t.model.set(s)}},section:"widgets"},{name:"Mantras",dataId:"settings-general-mantras",field:{name:"mantraVisible",get:function(){return m.models.customization.get("mantraVisible")},set:function(e){var t={mantraVisible:e};e&&!m.models.customization.get("greetingVisible")&&(t.greetingVisible=!0),m.models.customization.set(t)}},message:"Simple phrases to build positive mental habits",section:"widgets",beta:!1},{name:"Tasks",dataId:"settings-general-todo",field:"todoVisible",section:"widgets"},{name:"Quotes",dataId:"settings-general-quote",field:"quoteVisible",section:"widgets"},{name:"Countdowns",dataId:"settings-general-countdown",field:"countdownVisible",plusOnly:!0,requiredFeature:"countdown",message:"Count down to important dates and deadlines",section:"widgets"},{name:"Metrics",dataId:"settings-general-metric",field:"metricVisible",plusOnly:!0,requiredFeature:"plus",message:"Keep your important metrics at a glance",section:"widgets"},{name:"Focus Stats",dataId:"settings-focus-mode-insight",field:"focusInsightVisible",section:"widgets",message:"See how many minutes you've focused"},{name:"Notes",dataId:"settings-general-notes",field:"notesVisible",plusOnly:!0,requiredFeature:"notes",message:"Take quick notes and store wisdom to review",section:"widgets"},{name:"World Clocks",dataId:"settings-general-world-clocks",field:"multiClockVisible",plusOnly:!0,requiredFeature:"plus",message:"Keep track of time anywhere on Earth",section:"widgets",beta:!1},{name:"Tab Stash",dataId:"settings-general-tabs",field:"tabsVisible",plusOnly:!0,unsupported:m.utils.isTouchDevice()||m.utils.isPwa(),requiredFeature:"tab-stash",message:"Stash open tabs for later so you can focus",section:"widgets"},{name:"Sounds",dataId:"settings-general-soundscapes",field:"soundscapesVisible",plusOnly:!0,requiredFeature:"plus",message:"Sounds to help you focus and relax",section:"widgets"},{name:"Focus Mode",dataId:"settings-general-focus-mode",field:"focusModeVisible",unsupported:m.utils.isTouchDevice(),message:"Concentrate by eliminating distractions with timers and sounds.",section:"widgets",requiredFeature:"non-legacy"},{name:"Site Blocker",dataId:"settings-general-site-blocker",field:"siteBlockerVisible",plusOnly:!0,unsupported:m.utils.isTouchDevice()||m.utils.isPwa(),message:"Block access to distracting websites.",section:"widgets",requiredFeature:"site-blocker"},{name:"Clock",eventFeatureName:"default clock",dataId:"settings-general-clock",field:"clockVisible",section:"widgets"},{name:"Ask AI",dataId:"settings-general-ai",field:"askAiVisible",plusOnly:!0,requiredFeature:"plus",message:"Create, learn and problem-solve directly from your dashboard",section:"labs"}].filter((e=>!(1===v)))},render:function(){var e,t=m.isLoggedIn();this.$el.html(this.template({loggedIn:t})),this.$popBody=this.$(".pop-body");var s={customize:this.$el.find("#customize-list"),widgets:this.$el.find("#apps-list"),misc:this.$el.find("#misc-list"),labs:this.$el.find("#labs-list")};_.each(s,(function(e){e.empty()}));var i=this;return _.each(this.customizeItems,(function(e){var t=Object.assign({},e);("non-legacy"!==t.requiredFeature||i.featureAvailable("non-legacy"))&&(i.fieldHasOwnControl(e.field)&&(t.field=e.field.name),t.options?s[t.section].append(m.settingsAddin.templates["general-toggle-options"](t)):s[t.section].append(m.settingsAddin.templates["general-toggle-slider"](t)))})),this.updateControlStates(_.pluck(this.customizeItems,"field")),m.commandManager.execute("settings.color.picker",this.$el[0]),null==(e=m.settingsGeneralCenterBelowComponent)||e.$destroy(),setTimeout((()=>{const e=document.querySelector("#center-below-settings > div");m.settingsGeneralCenterBelowComponent=new a({render:e=>e(b)}).$mount(e)}),0),this},onAnimationEnd:function(e){m.utils.removePulseClass(e)},customizationModelChanged:function(e){if(e){var t=e.changedAttributes(),s=_.keys(t);this.updateControlStates(s)}},fieldHasOwnControl:function(e){return!("object"!=typeof e||null===e||!e.get||!e.set)},updateControlStates:function(e){var t=this;_.each(e,(function(e){var s=t.findMatchingItem(e);if(s){var i=t.fieldHasOwnControl(e),a=i?e.get():t.model.get(e),n=t.getFieldName(e);if(s.options){s.plusOnly&&!t.featureAvailable(s.requiredFeature)&&(a=s.default),t.$el.find("."+n).removeClass("active"),t.$el.find("."+n+"[data-option-value='"+a+"']").first().addClass("active")}else{var o=i?a:t.model.getComputedSetting(e);a=!(s.plusOnly&&!t.featureAvailable(s.requiredFeature))&&!!a;var l=t.$el.find("[data-related-widget='"+n+"']");if(l&&1===l.length){var r=l.first();if(r.toggleClass("on",a),a!==o){var d=t.model.overrides[e];d===t.model.settingOverriders.TEAM?(r.toggleClass("on",o),r.append('<span class="option-message"> &nbsp; &nbsp;Currently managed by team</span>'),r.addClass("balanced")):d===t.model.settingOverriders.BALANCE&&(r.append('<span class="option-message balanced-message"> &nbsp; &nbsp;Currently hidden by Balance mode (Customize here)</span>'),r.addClass("balanced"))}}}}}))},setOption:function(e){var t=e.attr("data-related-widget"),s=e.attr("data-option-value"),i=this.findMatchingItem(t);if(!i)return null;var a=_.findWhere(i.options,{value:s});if(!(i.plusOnly&&!this.featureAvailable(i.requiredFeature)||a&&a.plusOnly&&!this.isPlus())){m.models.activeBackground.isCustom()&&a&&"photo"===a.value&&a.plusOnly&&this.isPlus(),this.$el.find("."+t).removeClass("active"),e.addClass("active");var n={};return i.boolean?n[i.field]=JSON.parse(s):n[i.field]=s,this.model.save(n),m.Analytics.capture(i.name.toLowerCase()+" select",{feature:"themes",is_paid_event:i.plusOnly||a&&a.plusOnly||!1,new_value:s}),i}c(p.THEMES,"settings")},findMatchingItem:function(e){var t=this;return"object"==typeof e&&(e=e.name),this.customizeItems.find((function(s){return(t.fieldHasOwnControl(s.field)?s.field.name:s.field)===e}))},getFieldName:function(e){return this.fieldHasOwnControl(e)?e.name:e},toggleOption:function(e){var t=$(e.delegatedTarget),s=t.attr("data-option-value"),i=this.setOption(t);if(!0!==i){if(i){var a=_.findWhere(i.options,{value:s});if(a&&a.view&&a.view.handleClick){if($(e.target).closest(".sub-view").length>0&&a.view.ignoreClickEvent&&a.view.ignoreClickEvent(e.target))return;if(a.view.handleClick(e,!0),a.view.scrollIntoViewElement){var n=a.view.scrollIntoViewElement();n&&this.scrollIntoView(n)}}}m.trigger("globalEvent:settingsclick",e)}else e.stopImmediatePropagation()},scrollIntoView:function(e){var t=$(e),s=t.closest(".settings-view-container"),i=t.offset().top,a=s.offset().top;i-a-12<0&&s.animate({scrollTop:s[0].scrollTop+i-a-12})},configWidget:function(e){e.stopImmediatePropagation();var t=$(e.delegatedTarget).closest(".slide-toggle").attr("data-related-widget");if(t){var s=this.findMatchingItem(t);m.commandManager.execute(s.configCommand,null,s.configOptions)}},featureAvailable:function(e){return m.conditionalFeatures.featureEnabled(e)||m.conditionalFeatures.featureEnabled(e+"-degraded")},toggleSlider:function(e){if(!this.eatClicks){this.eatClicks=!0;var t,s=this;setTimeout((function(){s.eatClicks=!1}),250);var i=$(".verte");if(!($(e.target).closest("[data-option-value]").length||i.length>0&&$.contains(i[0],e.target)||$(e.delegatedTarget).hasClass("balanced"))){var a=$(e.delegatedTarget).attr("data-related-widget"),n=this.findMatchingItem(a);if(!n.plusOnly||this.featureAvailable(n.requiredFeature)){if(!n.unsupported){var o;if(this.fieldHasOwnControl(n.field))return o=!n.field.get(),n.field.set(o,e),$(e.delegatedTarget).toggleClass("on",o),void g(n);if(a){var l=this.model.get(n.field);if(n.options){var r;for(r=m.conditionalFeatures.featureEnabled("plus")?n.options:n.options.filter((function(e){return!e.plusOnly})),t=0;t<r.length;t++)if(r[t].value===l){t===r.length-1&&(t=-1),o=r[t+1].value;break}var d=$(e.delegatedTarget).find("."+a+"[data-option-value='"+o+"']").first();this.setOption(d)&&e.stopPropagation()}else{if("mantraVisible"===a&&!m.models.mantraSettings.get("firstMantraActivated"))return m.commandManager.executeAsync("settings.display",null,{section:"mantra-settings"}),void g(n);o=!this.model.get(a);var u={};u[a]=o,this.model.save(u),g(n)}}m.trigger("globalEvent:settingsclick",e)}}else"Ask AI"===n.name?c(p.AI_CHAT,"settings"):"Countdowns"===n.name?c(p.COUNTDOWNS,"settings"):"Metrics"===n.name?c(p.METRICS,"settings"):"Notes"===n.name?c(p.NOTES,"settings"):"World Clocks"===n.name?c(p.WORLD_CLOCKS,"settings"):"Sounds"===n.name?c(p.SOUNDS,"settings"):"Tab Stash"===n.name?c(p.TAB_STASH,"settings"):"Site Blocker"===n.name?c(p.SITE_BLOCKER,"settings"):"Calendar"===n.name&&c(p.CALENDAR_INTEGRATION,"settings")}}function g(e){e.skipAnalyticsOnChange||m.Analytics.capture("feature "+(o?"enable":"disable"),{is_paid_event:!!e.plusOnly,feature:e.eventFeatureName||e.name.toLowerCase(),location:"settings general"})}},switchToBalanceSettings:function(e){e&&(e.stopPropagation(),e.preventDefault()),m.commandManager.execute("settings.display",null,{section:"balance",showAdvanced:!0})},enableBookmarks:function(e){var t=this;e&&(e.stopPropagation(),e.preventDefault()),m.commandManager.executeAsync("settings.enableBookmarks",{callback:function(){var s=m.models.customization.get("bookmarksVisible"),i=m.models.bookmarksSettings.get("defaultMostVisited");$(e?e.delegatedTarget:'[data-related-widget="bookmarksVisible"]').toggleClass("on",s),t.$('[data-related-widget="mostVisited"]').toggleClass("on",i&&s)}})},isPlus:function(){return m.conditionalFeatures.featureEnabled("plus")},ensurePermissions:function(e,t,s,i){m.promisifiedChrome.permissions.contains(e).then((function(a){a?t(!0):d(e,{source:s,reason:i}).then(t)}))}})}}),C=Object.assign({"./templates/general.hbs":{compiler:[8,">= 4.3.0"],main:function(e,t,s,i,a){return'<header class="settings-header">\n\t<h3 data-test="general-header">General</h3>\n\t<p class="description">Customize your dashboard</p>\n</header>\n\n\n<h4 class="first">Show</h4>\n<ul id="apps-list" class="settings-list options-list"></ul>\n\n<div id="center-below-settings"><div></div></div>\n\n<h4>Labs</h4>\n<ul id="labs-list" class="settings-list options-list"></ul>\n\n<h4>Appearance</h4>\n<ul id="customize-list" class="settings-list options-list"></ul>\n\n\n<section class="u--touch-hide">\n\t<h5>Tip</h5>\n\t<p class="tip">Many items on your dashboard can be edited by double-clicking on them, including <strong>your name</strong> and your <strong>tasks</strong>.\n</section>\n'},useData:!0}});let k=null;const y=async()=>{if(k)return await k;k=new Promise((e=>f({addin:"9b62165c-8b05-4f9b-82b3-b093f4e77dc9",dependencies:["settings"]},w,C,(()=>{e()}))))};export{y as loadSettingsGeneralAddin};
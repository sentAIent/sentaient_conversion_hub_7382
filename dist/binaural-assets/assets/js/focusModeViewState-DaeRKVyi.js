import{d as e,r as t,e as a}from"./dynamic-import-helper-CTnsj-vI.js";import{u as i,e as o}from"./ViewState-DH0LvQYq.js";import{F as s,A as r,f as n,a as c,b as u,c as d}from"./focusModeState-BPyBLUbE.js";import{s as l,a as g,r as p,b as y,g as h}from"./focusModeHelpers-tDECULZC.js";import"./array-YYQw31d9.js";import"./style-D-IRYiWS.js";import"./Logger-cMW5At62.js";import"./string-BBKP9xfj.js";import"./appZStack-Zxx-wHpo.js";import"./LocalStorageStoreSyncedItem-DMdfjgsv.js";import"./reactiveCustomization-CEUTOUc3.js";import"./VueBase-C55TLWt3.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-B4IAWUO-.js";import"./portal-vue.esm-DdddSpdW.js";import"./PomodoroTimers-CyrfcuWH.js";import"./persistStore-BDYPfxbs.js";import"./constants-BfBD_H-d.js";const b=i("focusModeDash",{views:{[s.Idle]:{beforeLeave:async a=>{m.modal.hidden=!0,m.widgetManager.hideApps({layer:"focusMode"}),a===s.Transition.toString()?(await e.delay(r),l()):a===s.Focusing.toString()&&(m.widgetManager.addVueAppExemption(["focus-mode"],"focusMode"),l(),e.delay(100).then((async()=>{g(),t.disableAppTransitions=!1,await e.delay(100),m.modal.hidden=!1})))},defaultView:!0},[s.Transition]:{beforeLeave:t=>{t===s.Focusing.toString()?e.delay(r).then((async()=>{g(),await e.delay(100),m.modal.hidden=!1})):t===s.Idle.toString()&&(p(),y(),e.delay(r).then((async()=>{m.widgetManager.showApps({layer:"focusMode"}),await e.delay(100),m.modal.hidden=!1})))}},[s.Focusing]:{beforeLeave:t=>{p(),m.modal.hidden=!0,e.delay(r).then((()=>{y(),t===s.Idle.toString()&&m.widgetManager.showApps({layer:"focusMode"})}))}},[s.Celebration]:{beforeLeave:()=>{e.delay(r).then((async()=>{m.widgetManager.showApps({layer:"focusMode"}),await e.delay(100),m.modal.hidden=!1}))}}}}),w=b(),f=o("focusMode",{extend:(t,i)=>a(i,{state:()=>({backgroundScale:1,backgroundBlurLayerOpacity:0,backgroundTransitionDuration:null,cancelButtonVisible:!1,cancelButtonTimeout:void 0}),getters:{currentFocusModeView:()=>w.activeViewId,currentlyFocusing(){return this.currentFocusModeView===s.Focusing.toString()},currentlyTransitioning(){return[s.Transition.toString(),s.Celebration.toString()].includes(this.currentFocusModeView)},backgroundBlurLayerVisible(){return this.currentFocusModeView!==s.Idle.toString()}},actions:{async startFocusModeWithCancelPeriod(){t.popupActive=!1,clearTimeout(this.cancelButtonTimeout),this.cancelButtonVisible=!0,await w.setActiveView(s.Transition),this.backgroundTransitionDuration=c+u,await e.doubleRaf(),this.setFocusingStyleVariables(),this.cancelButtonTimeout=setTimeout((()=>{this.cancelButtonVisible=!1}),c),await e.delay(c)},async finalizeStartFocusModeAfterCancelPeriod(){await e.delay(u),this.backgroundTransitionDuration=null},async celebrateFocusMode(){t.popupActive=!1,await w.setActiveView(s.Celebration);this.backgroundTransitionDuration=1500,await e.doubleRaf(),this.resetFocusingStyleVariables(),await e.delay(this.backgroundTransitionDuration),this.backgroundTransitionDuration=null,await e.delay(d-1500)},async stopFocusMode(){t.popupActive=!1,this.resetFocusingStyleVariables(),await w.setActiveView(s.Idle)},async cancelFocusModeStart(){this.backgroundTransitionDuration=r,await e.doubleRaf(),await this.stopFocusMode(),await e.delay(this.backgroundTransitionDuration),this.backgroundTransitionDuration=null},setFocusingStyleVariables(){this.backgroundScale=1.1;h().blurBackground&&(this.backgroundBlurLayerOpacity=1)},resetFocusingStyleVariables(){this.backgroundScale=1,this.backgroundBlurLayerOpacity=0},async resumeFocusModeAfterTabLoad(){await w.setActiveView(s.Focusing),this.setFocusingStyleVariables(),this.backgroundTransitionDuration=0}}})}),S=f();n.switchOverToWatchedStoreItem((()=>S.currentlyTransitioning));export{f as default,b as useFocusModeDashViewStateStore,f as useFocusModeViewStateStore};
import{O as e,V as t}from"./dynamic-import-helper-CTnsj-vI.js";import{useCalendarEventStore as n}from"./calendarEvents-Dg9zHoRV.js";import{persistent as a}from"./reactiveCustomization-CEUTOUc3.js";import{T as s}from"./ToggleSwitch-BMo4SbmD.js";import{c as l,d as i}from"./accessToken-Cx8MZLdN.js";import o from"./BaseIcon-BW2ar6VN.js";import{n as r}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./VueBase-C55TLWt3.js";import{C as c}from"./SettingsTypes-BotgHBzA.js";import{h as d}from"./handlebarLoader-xbtIzd6B.js";import"./array-YYQw31d9.js";import"./style-D-IRYiWS.js";import"./Logger-cMW5At62.js";import"./string-BBKP9xfj.js";import"./index-DHQKZcbZ.js";import"./_commonjsHelpers-B3K3fdV-.js";import"./ClickOutside-DCLvi2fj.js";import"./pinia-B4IAWUO-.js";import"./portal-vue.esm-DdddSpdW.js";const g=r(e({name:"CalendarSettings",components:{ToggleSwitch:s,BaseIcon:o},setup:()=>({calendarEventStore:n(),persistent:a,connectToGoogleCalendar:l,disconnectGoogleCalendar:i}),mounted(){this.calendarEventStore.refresh()},methods:{toggleExclusion(e){const t=new Set(JSON.parse(a.excludedCalendars));e.enabled?t.add(e.id):t.delete(e.id),a.excludedCalendars=JSON.stringify(Array.from(t))}}}),(function(){var e=this,t=e._self._c;return e._self._setupProxy,t("div",{staticClass:"calendar-settings"},[e.calendarEventStore.linked?[e._l(e.calendarEventStore.calendarList,(function(n){return t("div",{key:n.id,staticClass:"calendar",on:{click:function(t){return e.toggleExclusion(n)}}},[t("div",{staticClass:"calendar-description"},[t("span",{staticClass:"calendar-color",style:{backgroundColor:n.backgroundColor}}),e._v(e._s(n.summary))]),t("toggle-switch",{attrs:{value:n.enabled}})],1)})),t("div",{staticClass:"grow"}),t("div",{staticClass:"disconnect calendar",on:{click:e.disconnectGoogleCalendar}},[t("div",{staticClass:"calendar-description"},[e._v("Disconnect")])])]:t("div",{staticClass:"button button-primary",on:{click:function(t){return e.connectToGoogleCalendar("settings")}}},[t("base-icon",{attrs:{src:"icon/google-calendar"}}),e._v(" Connect to Google Calendar ")],1)],2)}),[],!1,null,"e8b7ca8c").exports,u={1:function(e,t,n,a,s){return"on"},3:function(e,t,n,a,s){return"disabled"},5:function(e,t,n,a,s){return'<span class="unsupported">This feature is not yet supported on your current browser</span>'},compiler:[8,">= 4.3.0"],main:function(e,t,n,a,s){var l,i=null!=t?t:e.nullContext||{},o=e.lookupProperty||function(e,t){if(Object.prototype.hasOwnProperty.call(e,t))return e[t]};return'<h3>Calendar</h3>\n<p class="description">Display upcoming events and calendar metrics</p>\n\n<ul class="settings-list">\n\t<li class="slide-toggle has-toggle '+(null!=(l=o(n,"if").call(i,null!=t?o(t,"calendarEnabled"):t,{name:"if",hash:{},fn:e.program(1,s,0),inverse:e.noop,data:s,loc:{start:{line:5,column:36},end:{line:5,column:68}}}))?l:"")+" "+(null!=(l=o(n,"if").call(i,null!=t?o(t,"isTouchDevice"):t,{name:"if",hash:{},fn:e.program(3,s,0),inverse:e.noop,data:s,loc:{start:{line:5,column:69},end:{line:5,column:105}}}))?l:"")+' calendar-toggle" data-related-widget="calendarVisible" data-test="calendar-visible">\n\t\t<span class="toggle-slider"><svg class="toggle-switch" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><circle cx="50" cy="50" r="50"/></svg></span>\n\t\t<span class="setting-name">Calendar metric</span>\n\t\t<span class="option-message">Time until next event, open to see upcoming schedule</span>\n\t\t'+(null!=(l=o(n,"if").call(i,null!=t?o(t,"isTouchDevice"):t,{name:"if",hash:{},fn:e.program(5,s,0),inverse:e.noop,data:s,loc:{start:{line:9,column:2},end:{line:9,column:120}}}))?l:"")+'\n\t</li>\n\t<li class="slide-toggle has-toggle center-below-link" data-test="calendar-next-events">\n\t\t<span class="setting-name">Show next event in center</span>\n\t\t<div class="toggle-link">\n\t\t\t<svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 64 64"><path d="M18.465 11.536a5 5 0 1 1 7.07-7.072l24 24a5.002 5.002 0 0 1 0 7.071l-24 24a5 5 0 1 1-7.07-7.07l19.05-19.05a2 2 0 0 0 0-2.83l-19.05-19.05Z" /></svg>\n\t\t</div>\n\t</li>\n</ul>\n\n<h4>Manage your calendars</h4>\n<div id="calendar-settings-component"></div>\n'},useData:!0},p=Object.assign({"./commands/panel.js":e=>{m.commands.SettingsPanelCalendar=m.models.Command.extend({defaults:{id:"settings.panels.calendar"},execute:function(){return e.styleLoaded||(e.styleLoaded=!0,e.styles.style()),new e.views.Calendar}}),m.commandManager.registerCommandModel(m.commands.SettingsPanelCalendar,!1)},"./views/calendar.js":e=>{e.views.Calendar=m.settingsAddin.views.SettingsPanel.extend({attributes:{id:"settings-calendar",class:"settings-view settings-calendar","data-test":"settings-calendar"},panelid:"calendar",panelTitle:"Calendar Settings",template:e.templates.calendar,events:{"click .slide-toggle:not(.vue)":"toggleSlider","click .center-below-link":"openCenterBelowSettings"},initialize:function(){this.model=m.models.customization,this.listenTo(this.model,"change",this.updatePanel),this.listenTo(m.models.customization,"change:calendarVisible",this.updatePanel),m.Analytics.capture("settings panel show",{feature:"settings",name:"calendar"})},render:function(){var e;return this.$el.html(this.template({calendarEnabled:this.model.get("calendarVisible"),isTouchDevice:m.utils.isTouchDevice()})),this.setViewVars(),this.updatePanel(),null==(e=m.settingsCalendarComponent)||e.$destroy(),setTimeout((()=>{const e=document.querySelector("#calendar-settings-component");m.settingsCalendarComponent=new t({render:e=>e(g)}).$mount(e)}),0),this},setViewVars:function(){this.$mainContainer=this.$(".main-container"),this.$calendarToggler=this.$(".calendar-toggle"),this.$calendarComponentContainer=this.$("#calendar-settings-component")},updatePanel:function(){var e=this.model.get("calendarVisible");this.$calendarToggler.toggleClass("on",e),this.$calendarComponentContainer.css("display",e?"block":"none")},toggleSlider:function(e){if(!this.eatClicks){this.eatClicks=!0;var t=this;setTimeout((function(){t.eatClicks=!1}),250);var n=$(e.delegatedTarget).attr("data-related-widget");if("calendarVisible"===n){var a=!this.model.get(n),s={};s[n]=a,this.model.save(s),m.Analytics.capture("feature "+(a?"enable":"disable"),{feature:"calendar",location:"settings calendar"})}}},openCenterBelowSettings:function(e){e.preventDefault(),this.model.save({centerBelowVisible:!0,centerBelowApp:c.Schedule}),m.Analytics.capture("feature center below calendar enable",{feature:"calendar",location:"settings calendar"}),m.commandManager.execute("settings.display",null,{section:"general"}),setTimeout((()=>{const e=document.querySelector("#center-below-settings");e&&e.scrollIntoView({behavior:"smooth"})}),100)}})}}),h=Object.assign({"./templates/calendar.hbs":u});let v=null;const f=async()=>{if(v)return await v;v=new Promise((e=>d({addin:"010ca36c-0f4b-40c4-a90c-9dc01a85464c",dependencies:["settings"]},p,h,(()=>{e()}))))};export{f as loadSettingsCalendarAddin};
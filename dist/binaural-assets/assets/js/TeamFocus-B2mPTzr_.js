import{u as e}from"./useAllComponentsMounted-VdWDSwjD.js";import{T as t}from"./index-CypNqh9b.js";import{c as s,q as i}from"./dynamic-import-helper-CTnsj-vI.js";import{B as a}from"./BaseDropdown-CB3yfeIu.js";import{B as o}from"./BaseDropdownOption-tB3ldrjh.js";import l from"./BaseIcon-BW2ar6VN.js";import{n}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./Logger-cMW5At62.js";import"./array-YYQw31d9.js";import"./pinia-B4IAWUO-.js";import"./localStorage-B4mFdj8F.js";import"./legacyUserMigration-CaazFMYU.js";import"./style-D-IRYiWS.js";import"./enums-1c3kgXdw.js";import"./migrateLegacyUserMessageHandler-CZ8nZZlg.js";import"./auth-BwdMrzFn.js";import"./persistStore-BDYPfxbs.js";import"./embeddedApp-Bd9r3bdf.js";import"./experiments-6paecGsK.js";import"./flashMessageQueue-C7gl3k6c.js";import"./info-DdD9a7JK.js";import"./constants-Bt_TxKWw.js";import"./index-DHG7crjO.js";import"./appZStack-Zxx-wHpo.js";import"./ResizeSensor-ZXOsDHeC.js";import"./promisifiedChrome-vBWwQWBS.js";import"./modal-BWwnzHDf.js";import"./string-BBKP9xfj.js";import"./BaseDropdownContent-C68ik0op.js";import"./constants-CALDQiUE.js";import"./index-998LMmMn.js";import"./portal-vue.esm-DdddSpdW.js";import"./icon-ellipsis-D7nTOXaQ.js";const r=Backbone.Model.extend({defaults:{title:"",createdDate:m.date(),updatedDate:m.now(),label:"",active:!1,serverSetId:!1},initialize:function(){this.idAttribute=this.collection.idAttribute||"csid"}});var d="https://api.momentumdash.com/";const p=m.collect.SyncedCollection.extend({initialize:function(e,t){this.model=r,(t=t||{}).name="teamFocus",t.serverIdAttribute="focusUuid",t.model=this.model,t.transientProps=["createdDate"],t.apiUrl=d+"team/focus",m.collect.SyncedCollection.prototype.initialize.call(this,e,t)}});const c=n({name:"TeamFocus",components:{BaseIcon:l,BaseDropdownOption:o,BaseDropdown:a,ThreeColLayout:t},setup:()=>({...e()}),bb:()=>({collection:new p}),setup:()=>({dropdown:s()}),data:()=>({goal:"",label:"",editing:!1,pulse:!1}),computed:{model(){return this.collection.length?this.collection.find((e=>e.active)):null}},watch:{model(){this.model&&(this.goal=this.model.title,this.label=this.model.label)}},created(){this.collection.fetch({reset:!0}),this.model&&(this.goal=this.model.title,this.label=this.model.label)},methods:{removePulse(){this.pulse=!1},edit(){var e;this.$admin&&(this.editing=!0,null==(e=this.dropdown)||e.closeDropdown(),i((()=>{this.$refs.goal.focus()})))},onClickOutside(){this.validateGoal(!1)&&this.save(),this.editing=!1},saveAndFinishEditing(){this.validateGoal()&&(this.save(),this.editing=!1)},validateGoal(e=!0){return!!this.goal||(e&&(this.pulse=!0),void this.$refs.goal.focus())},save(e){var t;e&&(e.preventDefault(),e.stopPropagation()),this.model?this.model.save({label:this.label,title:this.goal}):this.collection.create({label:this.label,title:this.goal,active:!0}),null==(t=this.dropdown)||t.closeDropdown()},clear(){var e;null==(e=this.dropdown)||e.closeDropdown(),this.goal="",this.label="",this.model.active=!1},revert(){this.model?(this.goal=this.model.title,this.label=this.model.label,this.editing=!1):this.editing=!1}}},(function(){var e=this,t=e._self._c;return t("three-col-layout",{staticClass:"team-focus has-dash-icon team-focus-content",attrs:{"data-test":"team-focus"},scopedSlots:e._u([{key:"center",fn:function(){return[e.editing?t("span",{directives:[{name:"click-outside",rawName:"v-click-outside",value:e.onClickOutside,expression:"onClickOutside"}],staticClass:"edit"},[t("span",{staticClass:"input-wrapper goal-label-input-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.label,expression:"label",modifiers:{trim:!0}}],ref:"label",staticClass:"input goal-label",attrs:{placeholder:"PERIOD","data-test":"label-edit"},domProps:{value:e.label},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveAndFinishEditing.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.save.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.revert.apply(null,arguments)}],input:function(t){t.target.composing||(e.label=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),t("span",{staticClass:"hidden goal-label"},[e._v(e._s(e.label.replace(/ /g," ")||" "))])]),t("span",{staticClass:"input-wrapper goal-value-input-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.goal,expression:"goal",modifiers:{trim:!0}}],ref:"goal",staticClass:"input goal-value",class:{pulse:e.pulse},attrs:{placeholder:"TEAM GOAL","data-test":"goal-edit"},domProps:{value:e.goal},on:{keyup:[function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.saveAndFinishEditing.apply(null,arguments)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"esc",27,t.key,["Esc","Escape"])?null:e.revert.apply(null,arguments)}],keydown:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"tab",9,t.key,"Tab")||t.ctrlKey||t.shiftKey||t.altKey||t.metaKey?null:e.saveAndFinishEditing.apply(null,arguments)},animationend:e.removePulse,input:function(t){t.target.composing||(e.goal=t.target.value.trim())},blur:function(t){return e.$forceUpdate()}}}),t("span",{staticClass:"hidden goal-value"},[e._v(e._s(e.goal.replace(/ /g," ")||" "))])])]):t("span",[t("transition",{attrs:{name:"fade",mode:"out-in"}},[e.model?t("div",{key:"1",staticClass:"view",on:{dblclick:e.edit}},[t("span",{staticClass:"goal-label",class:{empty:!e.label},attrs:{"data-test":"label"}},[e._v(e._s(e.label))]),t("span",{staticClass:"goal-value",attrs:{"data-test":"goal"}},[e._v(e._s(e.goal))])]):e.$admin?t("div",{key:"2"},[t("button",{staticClass:"button dash-button add-button",attrs:{"data-test":"add"},on:{click:e.edit}},[t("base-icon",{attrs:{src:"icon-plus",size:"12px"}}),e._v(" Team Goal ")],1)]):e._e()])],1)]},proxy:!0},{key:"right",fn:function(){return[e.model&&!e.editing&&e.$admin?t("base-dropdown",{staticClass:"team-focus-dropdown",attrs:{"data-test":"more-toggle","container-class":"dash"},scopedSlots:e._u([{key:"toggle",fn:function(){return[t("div",{staticClass:"icon-wrapper dark dark-full"},[t("base-icon",{staticClass:"icon",attrs:{src:"icon-ellipsis",size:"15px"}})],1)]},proxy:!0}],null,!1,3556559132)},[t("base-dropdown-option",{attrs:{"data-test":"dropdown-edit"},on:{click:e.edit}},[t("base-icon",{attrs:{src:"pencil"}}),t("span",[e._v("Edit")])],1),t("base-dropdown-option",{attrs:{"data-test":"dropdown-clear"},on:{click:e.clear}},[t("base-icon",{attrs:{src:"x"}}),t("span",[e._v("Clear")])],1)],1):e._e()]},proxy:!0}])})}),[],!1,null,"56531f7e").exports;export{c as default};
import{O as t,v as e,am as a,n as s}from"./dynamic-import-helper-CTnsj-vI.js";import{S as i}from"./SmoothReflow-QsxkeVSi.js";import o from"./icon-profile-womUQGUp.js";import n from"./icon-close-DRlspKs3.js";import{n as r}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import"./array-YYQw31d9.js";import"./style-D-IRYiWS.js";import"./Logger-cMW5At62.js";import"./string-BBKP9xfj.js";import"./ResizeSensor-ZXOsDHeC.js";import"./useAllComponentsMounted-VdWDSwjD.js";const c={HIDDEN:0,DELETE:1,CONFIRM:2,ERROR:3,ERROR_PLUS:4};const l=r(t({name:"SafariAccount",components:{SmoothReflow:i},setup:()=>({deleting:!1,VIEWS:c}),data:()=>({currentView:c.HIDDEN,name:m.models.customization.get("displayname"),email:localStorage.getItem("email")||""}),mounted(){m.widgetManager.hideApps()},destroyed(){m.widgetManager.showApps()},methods:{async deleteAccount(){if(!this.deleting)try{this.deleting=!0,await e.delete("/user"),a().finally((function(){s.sendCrossTabMessage("reload"),window.location.reload()}))}catch(t){console.error(t),this.currentView=this.VIEWS.ERROR}finally{this.deleting=!1}},close(){m.trigger("modal:close")}}}),(function(){var t=this,e=t._self._c;return t._self._setupProxy,e("div",[e("div",{staticClass:"overlay"},[e("transition",{attrs:{name:"slide-fade"}},[e("div",{directives:[{name:"click-outside",rawName:"v-click-outside",value:t.close,expression:"close"}],staticClass:"app light light-full modal",attrs:{"data-test":"safari-account"}},[e("div",{staticClass:"safari-account"},[e("h2",[e("inline-svg",{staticClass:"icon",attrs:{src:o}}),t._v(" Profile ")],1),e("div",{staticClass:"fake-field"},[e("div",{staticClass:"label"},[t._v("Name")]),e("div",{staticClass:"value"},[t._v(t._s(t.name))])]),e("div",{staticClass:"fake-field"},[e("div",{staticClass:"label"},[t._v("Email")]),e("div",{staticClass:"value"},[t._v(t._s(t.email))])]),e("div",{staticClass:"section-title",attrs:{"data-test":"delete-account"},on:{click:function(e){t.currentView=t.VIEWS.DELETE}}},[t._v("Delete your Momentum account")]),e("smooth-reflow",{attrs:{"hide-overflow":!0,"transition-group":!0}},[t.currentView===t.VIEWS.DELETE?e("div",{key:t.VIEWS.DELETE,staticClass:"card-delete"},[e("p",{staticClass:"warning"},[t._v("Your account and all of its data will be permanently deleted.")]),e("button",{staticClass:"button button-error",attrs:{"data-test":"delete-account-confirm"},on:{click:function(e){t.currentView=t.$plus?t.VIEWS.ERROR_PLUS:t.VIEWS.CONFIRM}}},[t._v("Delete account")])]):t.currentView===t.VIEWS.CONFIRM?e("div",{key:t.VIEWS.CONFIRM,staticClass:"card-delete"},[e("p",{staticClass:"warning"},[t._v("Are you sure you want to delete your account?")]),e("p",[t._v("You will be logged out of your account and lose your data forever.")]),e("button",{staticClass:"button button-error",attrs:{"data-test":"delete-account-confirm-confirm"},on:{click:t.deleteAccount}},[t._v("Yes, proceed")]),e("button",{staticClass:"button button-neutral",on:{click:function(e){t.currentView=t.VIEWS.DELETE}}},[t._v("No, I've changed my mind")])]):t.currentView===t.VIEWS.ERROR?e("div",{key:t.VIEWS.ERROR,staticClass:"card-delete"},[e("p",{staticClass:"warning"},[t._v("There was an issue deleting your account. Please "),e("span",{staticClass:"try-again",on:{click:function(e){t.currentView=t.VIEWS.CONFIRM}}},[t._v("try again")]),t._v(" or "),e("a",{attrs:{target:"_blank",href:"http://momentumdash.com/contact",title:"help@momentumdash.com"}},[t._v("contact us")]),t._v(" for assistance.")])]):t.currentView===t.VIEWS.ERROR_PLUS?e("div",{key:t.VIEWS.ERROR_PLUS,staticClass:"card-delete"},[e("p",{staticClass:"warning"},[t._v("Please cancel your Momentum Plus subscription first. "),e("a",{attrs:{href:"https://support.apple.com/en-ca/HT202039",target:"_blank"}},[t._v("Here's how")])])]):t._e()])],1),e("span",{staticClass:"icon-wrapper hide",on:{click:t.close}},[e("inline-svg",{staticClass:"icon icon-hide",attrs:{src:n}})],1)])])],1)])}),[],!1,null,"310d079a").exports;export{l as default};
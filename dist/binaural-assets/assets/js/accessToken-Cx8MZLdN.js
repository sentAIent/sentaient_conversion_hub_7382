const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/js/calendarEvents-Dg9zHoRV.js","assets/js/dynamic-import-helper-CTnsj-vI.js","assets/js/array-YYQw31d9.js","assets/js/style-D-IRYiWS.js","assets/css/style-6nm_MYpP.css","assets/js/Logger-cMW5At62.js","assets/js/string-BBKP9xfj.js","assets/js/index-DHQKZcbZ.js","assets/js/reactiveCustomization-CEUTOUc3.js","assets/js/VueBase-C55TLWt3.js","assets/js/_commonjsHelpers-B3K3fdV-.js","assets/js/ClickOutside-DCLvi2fj.js","assets/js/pinia-B4IAWUO-.js","assets/js/portal-vue.esm-DdddSpdW.js"])))=>i.map(i=>d[i]);
import{_ as e}from"./style-D-IRYiWS.js";import{m as a}from"./Logger-cMW5At62.js";import{A as t,v as n}from"./dynamic-import-helper-CTnsj-vI.js";let r=null;const s=async()=>{const e=await a.get("googleCalendarAccessToken"),[t,n]=(e||"").split(",");if(n&&Number(t)>Date.now())return n;{null===r&&(r=o());const e=await r;return e?(await a.set("googleCalendarAccessToken",e),r=null,e.split(",")[1]):(await a.delete("googleCalendarAccessToken"),r=null,null)}},o=async()=>{try{const e=await n.get("settings/calendar/providers/1/token");if(e.data.token)return`${e.data.expires},${e.data.token}`}catch(e){console.error(e)}return null},c=async a=>{t.capture("calendar connect to google calendar click",{feature:"calendar",source:a});const r=(await e((async()=>{const{useCalendarEventStore:e}=await import("./calendarEvents-Dg9zHoRV.js");return{useCalendarEventStore:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))).useCalendarEventStore();return new Promise(((e,a)=>{n.put("settings/calendar/providers",{provider_id:1}).then((a=>{const t=window.open(a.data.authorizationUrl,"sso","popup=true"),n=window.setInterval((()=>{t&&t.closed&&(clearInterval(n),r.refresh(!0),e())}),500)})).catch((e=>a(e)))}))},l=async()=>{t.capture("calendar disconnect google calendar click",{feature:"calendar"});const r=(await e((async()=>{const{useCalendarEventStore:e}=await import("./calendarEvents-Dg9zHoRV.js");return{useCalendarEventStore:e}}),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))).useCalendarEventStore();return new Promise(((e,t)=>{n.delete("settings/calendar/providers/1").then((async()=>{await a.delete("googleCalendarAccessToken"),r.refresh(!0),e()})).catch((e=>t(e)))}))};export{c,l as d,s as g};
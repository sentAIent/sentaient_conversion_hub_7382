import{S as e}from"./SoftFocus-BUhesXB-.js";import{u as r}from"./useAllComponentsMounted-VdWDSwjD.js";import{K as t,O as o,d as s,aH as i,c as a,A as c}from"./dynamic-import-helper-CTnsj-vI.js";import{p as n}from"./promisifiedChrome-vBWwQWBS.js";import h from"./BaseIcon-BW2ar6VN.js";import{computed as p,persistent as u}from"./reactiveCustomization-CEUTOUc3.js";import l from"./search-B-fPPBNd.js";import d from"./search-_4L9pO9R.js";import{n as f}from"./_plugin-vue2_normalizer-DeUNqxFl.js";import{B as v}from"./BaseDropdown-CB3yfeIu.js";import{B as w}from"./BaseDropdownText-2W0hM9-D.js";import{B as g}from"./BaseDropdownOption-tB3ldrjh.js";var S=(e=>(e.Google="google",e.Bing="bing",e.DuckDuckGo="duckduckgo",e.Ecosia="ecosia",e))(S||{});const b={google:{name:"Google",iconSrc:"icon/search/google",iconWhiteSrc:"icon/search/google-white",prefix:"https://www.google.com/search?q="},bing:{name:"Bing",iconSrc:"icon/search/bing",iconWhiteSrc:"icon/search/bing-white",prefix:"https://www.bing.com/search?q=",suffix:"&PC=ATMM&FORM=MMXT01"},duckduckgo:{name:"DuckDuckGo",iconSrc:"icon/search/duckduckgo",iconWhiteSrc:"icon/search/duckduckgo-white",prefix:"https://duckduckgo.com/?q="},ecosia:{name:"Ecosia",iconSrc:"icon/search/ecosia",iconWhiteSrc:"icon/search/ecosia-white",prefix:"https://www.ecosia.org/search?q=",suffix:"&tt=c4ccf3a1"}},x=()=>!t()&&"chrome"in window,k=new c({feature:"search"});const y=f(o({name:"SearchInput",directives:{SoftFocus:e},components:{BaseIcon:h},props:{bigSearch:{type:Boolean,default:!1},placeholder:{type:String,default:""}},setup:()=>({...r(),aiToolTipText:`Ask AI (${s.getMetaKeyName()} + Enter)`,isChrome:i(),input:a()}),data:()=>({searchInput:"",inputHasFocus:!1}),computed:{searchUrl(){var e,r;return`${null==(e=this.provider)?void 0:e.prefix}${encodeURIComponent(this.searchInput)}${(null==(r=this.provider)?void 0:r.suffix)||""}`},location(){return this.bigSearch?"center":"top left"},hasInputLength(){return!!this.searchInput.length},provider(){const e=p.searchProvider;return x()||"browser"!==e?"browser"===e?{name:"Browser default",useBrowserApi:!0}:b[e]:b[S.Google]}},created(){m.on("globalEvent:esc",this.blurSearch),m.on("globalEvent:toggleSearch",this.focusSearchOnUserAction)},destroyed(){m.off("globalEvent:esc",this.blurSearch),m.off("globalEvent:toggleSearch",this.focusSearchOnUserAction)},methods:{focusSearch(){var e;null==(e=this.input)||e.focus()},focusSearchOnDropdownCloseIfTouch(e){!e&&this.$touch&&this.$refs.input&&this.focusSearch()},focusSearchOnUserAction(e){var r;this.inputHasFocus||(this.focusSearch(),k.capture("search focus",{location:this.location,provider:null==(r=this.provider)?void 0:r.name.toLowerCase(),method:e instanceof PointerEvent?"click":"hotkey"})),this.inputHasFocus=!0},blurSearch(){var e;null==(e=this.input)||e.blur()},async submit(e,r=!1){var t,o;"metaKey"in e&&e.metaKey&&(r=!0),this.hasInputLength&&(r&&this.bigSearch?(this.$emit("showChatPopup",this.searchInput),this.searchInput=""):this.provider&&(null==(t=this.provider)?void 0:t.name.toLowerCase())&&(k.capture("search submit",{location:this.location,provider:null==(o=this.provider)?void 0:o.name.toLowerCase()}),this.provider.useBrowserApi?(await n.permissions.request({permissions:["search"]}),await chrome.search.query({text:this.searchInput,disposition:"CURRENT_TAB"})):window.location.href=this.searchUrl))},sendStartTypingEvent(e){var r;1===this.searchInput.length&&"inputType"in e&&"insertText"===e.inputType&&k.capture("search start typing",{location:this.location,provider:null==(r=this.provider)?void 0:r.name.toLowerCase()})}}}),(function(){var e,r=this,t=r._self._c;return r._self._setupProxy,t("div",{staticClass:"search-form"},[t("div",{staticClass:"search-underline"}),t("div",{staticClass:"search-icon-container"},[t("inline-svg",{staticClass:"icon dash-icon icon-search",attrs:{src:r.bigSearch?l:d,"data-test":"icon-search"}})],1),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:r.searchInput,expression:"searchInput",modifiers:{trim:!0}},{name:"soft-focus",rawName:"v-soft-focus",value:r.$touch,expression:"$touch"}],ref:"input",staticClass:"search-input",attrs:{id:"search-input","search-url":r.searchUrl,type:"text",autocomplete:"off","data-test":"search-input",placeholder:r.placeholder},domProps:{value:r.searchInput},on:{click:r.focusSearchOnUserAction,blur:[function(e){r.inputHasFocus=!1},function(e){return r.$forceUpdate()}],input:[function(e){e.target.composing||(r.searchInput=e.target.value.trim())},r.sendStartTypingEvent],keydown:function(e){return!e.type.indexOf("key")&&r._k(e.keyCode,"enter",13,e.key,"Enter")?null:r.submit.apply(null,arguments)}}}),t("div",{staticClass:"right-wrapper"},[t("transition",{attrs:{name:"fade-fast"}},[r.bigSearch&&r.searchInput?t("div",{staticClass:"icon-container ask-ai",on:{click:function(e){return r.submit(e,!0)}}},[t("base-icon",{attrs:{title:r.aiToolTipText,src:"icon/apps/chat",size:"18px"}})],1):r._e()]),(null==(e=r.provider)?void 0:e.iconWhiteSrc)?t("div",{staticClass:"icon-container"},[t("base-icon",{attrs:{src:r.provider.iconWhiteSrc,size:"18px"}})],1):r._e()],1)])}),[],!1,null,"8d915c56").exports,C=new c({feature:"search",location:"search"});const B=f(o({name:"SearchProviderDropdown",components:{BaseDropdown:v,BaseDropdownText:w,BaseDropdownOption:g,BaseIcon:h},props:{bigSearch:{type:Boolean,default:!1}},setup:()=>({dropdown:a()}),computed:{searchProviderSelected:{get(){const e=u.searchProvider;return x()||"browser"!==e?e:S.Google},set(e){u.searchProvider=e}},allSearchProviders:()=>x()?{browser:{name:"Browser default",useBrowserApi:!0},...b}:b},watch:{searchProviderSelected(){C.capture("search provider switch",{location:this.bigSearch?"big search":"search app",new_value:this.searchProviderSelected.toLowerCase()})}},methods:{setSearchProvider(e){var r;this.searchProviderSelected=e,null==(r=this.dropdown)||r.closeDropdown(),this.$emit("focus")}}}),(function(){var e=this,r=e._self._c;return e._self._setupProxy,r("base-dropdown",{ref:"dropdown",staticClass:"search-provider-dropdown",attrs:{"data-test":"provider-toggle"}},[r("base-dropdown-text",{staticClass:"switch-to-heading",attrs:{"is-title":!0}},[e._v("Search with")]),e._l(e.allSearchProviders,(function(t,o){return r("base-dropdown-option",{key:o,attrs:{active:o===e.searchProviderSelected,"data-test":"select-"+o},nativeOn:{click:function(r){return e.setSearchProvider(o)}}},["iconSrc"in t?r("base-icon",{staticClass:"dropdown-icon",attrs:{src:t.iconSrc,size:"13px"}}):e._e(),r("span",[e._v(e._s(t.name))])],1)}))],2)}),[],!1,null,"b22d42f8").exports;export{y as S,B as a};